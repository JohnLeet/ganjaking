{"version":3,"file":"gp-inventory.js","mappings":"sOAEMA,EAAIC,OAAOC,O,QAEjB,WAUC,WACC,GADD,WACGC,EAAO,UAAEC,EAAM,SAAEC,EAAa,gBAAEC,EAAe,kBAAEC,EAAgB,mBAGnEC,KAAKL,QAAUA,EACfK,KAAKJ,OAASA,EACdI,KAAKH,cAAgBA,EACrBG,KAAKF,gBAAkBA,EACvBE,KAAKD,iBAAmBA,EAExBC,KAAKC,MAAQT,EAAE,kBAAkBQ,KAAKJ,QACtCI,KAAKE,aAAeV,EAAE,UAAUQ,KAAKJ,OAAM,IAAII,KAAKH,eAEpDJ,OAAOU,MAAMC,UAAU,sBAAsB,SAACC,EAAmBT,EAAgBU,IACpB,IAAxDd,EAAEe,QAAQC,SAASF,GAAU,EAAKR,kBACrC,EAAKW,QAAQ,CACZZ,cAAe,EAAKA,cACpBa,eAAgBF,SAASF,GACzBJ,aAAc,EAAKA,aACnBS,cAAeN,OAsEpB,OAhEC,YAAAI,QAAA,SAAQG,GAAR,WACC,IAAIA,EAAKC,cAAeb,KAAKE,aAAaY,GAAG,iBAA7C,CAIA,IAAMC,EAAqC,GAE3Cf,KAAKC,MAAMe,KAAK,2BAA2BC,MAAK,WAC/C,IAAMC,EAAM1B,EAAEQ,MAAMmB,KAAK,QAEpBD,IAImC,UAAnClB,KAA0BoB,MAAwD,aAAnCpB,KAA0BoB,KACxEpB,KAA0BqB,UAC9BN,EAASG,GAAQ1B,EAAEQ,MAAMsB,OAG1BP,EAASG,GAAQ1B,EAAEQ,MAAMsB,UAI3B,IAAMC,EAAI,OAQNR,GAAQ,CACXS,OAAQ,oBACRC,SAAUzB,KAAKD,iBACf2B,QAAS1B,KAAKJ,OACd+B,gBAAiBf,EAAKf,cACtB+B,iBAAkBhB,EAAKF,eACvBmB,6BAA8BjB,EAAKC,qBAI7BU,EAAiB,WAExBvB,KAAKE,aAAa4B,SAAS,wBAE3BtC,EAAEuC,KAAK/B,KAAKL,QAAS4B,GAAMS,MAAK,SAACC,GAChC,EAAK/B,aAAagC,YAAY,wBAE1BD,EAASE,SACZ,EAAKjC,aAAakC,KAAKH,EAASV,MAYjC9B,OAAOU,MAAMkC,SAAS,sBAAuB,EAAKnC,aAAcU,EAAKD,cAAeC,EAAKC,kBAG5F,EAnGA,GCFApB,OAAO6C,cAAgB,G","sources":["webpack://gp-inventory/./js/src/frontend/GPIProperties.ts","webpack://gp-inventory/./js/src/frontend/index.ts"],"sourcesContent":["type JQueryInput = JQuery<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>;\n\nconst $ = window.jQuery;\n\nexport default class GPIProperties {\n\tpublic ajaxUrl: string;\n\tpublic formId: number;\n\tpublic targetFieldId: number;\n\tpublic triggerFieldIds: number[];\n\tpublic ajaxRefreshNonce: string;\n\n\tpublic $form: JQuery<HTMLFormElement>;\n\tpublic $targetField: JQueryInput;\n\n\tconstructor(\n\t\t{ ajaxUrl, formId, targetFieldId, triggerFieldIds, ajaxRefreshNonce }\n\t\t\t: Pick<GPIProperties, 'ajaxUrl' | 'formId' | 'targetFieldId' | 'triggerFieldIds' | 'ajaxRefreshNonce'>\n\t) {\n\t\tthis.ajaxUrl = ajaxUrl;\n\t\tthis.formId = formId;\n\t\tthis.targetFieldId = targetFieldId;\n\t\tthis.triggerFieldIds = triggerFieldIds;\n\t\tthis.ajaxRefreshNonce = ajaxRefreshNonce;\n\n\t\tthis.$form = $(`#gform_wrapper_${this.formId}`);\n\t\tthis.$targetField = $(`#field_${this.formId}_${this.targetFieldId}`);\n\n\t\twindow.gform.addAction('gform_input_change', (elem: JQueryInput, formId: string, fieldId: string) => {\n\t\t\tif ($.inArray(parseInt(fieldId), this.triggerFieldIds) !== -1) {\n\t\t\t\tthis.refresh({\n\t\t\t\t\ttargetFieldId: this.targetFieldId,\n\t\t\t\t\ttriggerFieldId: parseInt(fieldId),\n\t\t\t\t\t$targetField: this.$targetField,\n\t\t\t\t\t$triggerField: elem,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\trefresh(args: { targetFieldId: number, triggerFieldId?: number, $targetField: JQueryInput, $triggerField?: JQueryInput, initialLoad?: boolean}) {\n\t\tif (args.initialLoad && this.$targetField.is('.gfield_error')) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst formData: { [input: string]: any } = {};\n\n\t\tthis.$form.find('input, select, textarea').each(function () {\n\t\t\tconst name =$(this).attr('name');\n\n\t\t\tif (!name) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ((this as HTMLInputElement).type === 'radio' || (this as HTMLInputElement).type === 'checkbox') {\n\t\t\t\tif ((this as HTMLInputElement).checked) {\n\t\t\t\t\tformData[name] = $(this).val();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tformData[name] = $(this).val();\n\t\t\t}\n\t\t});\n\n\t\tconst data:{\n\t\t\taction: string\n\t\t\tsecurity: string\n\t\t\tform_id: number\n\t\t\ttarget_field_id: number\n\t\t\ttrigger_field_id?: number\n\t\t\t[input: string]: any,\n\t\t} = {\n\t\t\t...formData,\n\t\t\taction: 'gpi_refresh_field',\n\t\t\tsecurity: this.ajaxRefreshNonce,\n\t\t\tform_id: this.formId,\n\t\t\ttarget_field_id: args.targetFieldId,\n\t\t\ttrigger_field_id: args.triggerFieldId,\n\t\t\tgpi_initial_property_refresh: args.initialLoad,\n\t\t};\n\n\t\t// Prevent AJAX-enabled forms from intercepting our AJAX request.\n\t\tdelete data['gform_ajax'];\n\n\t\tthis.$targetField.addClass('gpi-refreshing-field');\n\n\t\t$.post(this.ajaxUrl, data).done((response) => {\n\t\t\tthis.$targetField.removeClass('gpi-refreshing-field');\n\n\t\t\tif (response.success) {\n\t\t\t\tthis.$targetField.html(response.data);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Action fired after a field with inventory dependent on a property is refreshed.\n\t\t\t *\n\t\t\t * @since 1.0-beta-1.3\n\t\t\t *\n\t\t\t * @param {JQuery}\t$targetField \tField with inventory that was refreshed.\n\t\t\t * @param {JQuery}\t$triggerField \tProperty field that caused the field with inventory to be refreshed.\n\t\t\t * @param boolean\tinitialLoad\t\tWhether the field was refreshed on the initial load of the form.\n\t\t\t */\n\t\t\twindow.gform.doAction('gpi_field_refreshed', this.$targetField, args.$triggerField, args.initialLoad);\n\t\t});\n\t}\n}\n","import GPIProperties from \"./GPIProperties\";\n\nwindow.GPIProperties = GPIProperties;\n"],"names":["$","window","jQuery","ajaxUrl","formId","targetFieldId","triggerFieldIds","ajaxRefreshNonce","this","$form","$targetField","gform","addAction","elem","fieldId","inArray","parseInt","refresh","triggerFieldId","$triggerField","args","initialLoad","is","formData","find","each","name","attr","type","checked","val","data","action","security","form_id","target_field_id","trigger_field_id","gpi_initial_property_refresh","addClass","post","done","response","removeClass","success","html","doAction","GPIProperties"],"sourceRoot":""}