!function(t){"use strict";function x(t){this.value=t}var s=["round","ceil","floor","abs","exp","sqrt","sin","cos","tan","pi","(",")","P","C"," ","asin","acos","atan","7","8","9","int","cosh","acosh","ln","^","root","4","5","6","/","!","tanh","atanh","Mod","1","2","3","&&","||","*","sinh","asinh","e","log","0",".","+","-",",","Sigma","n","Pi","pow",">","<",">=","<=","==","!=","%","min","max"],r=["round","ceil","floor","abs","exp","sqrt","sin","cos","tan","&pi;","(",")","P","C"," ","asin","acos","atan","7","8","9","Int","cosh","acosh"," ln","^","root","4","5","6","&divide;","!","tanh","atanh"," Mod ","1","2","3","&amp;&amp;","||","&times;","sinh","asinh","e"," log","0",".","+","-",",","&Sigma;","n","&Pi;","pow","&gt;","&lt;","&gt;=","&lt;=","==","!=","%","min","max"],i=[],l=[[],["1","2","3","7","8","9","4","5","6","+","-","*","/","(",")","^","!","P","C","e","0",".",",","n"," ",">","<","%"],["pi","ln","Pi","&&","||",">=","<=","==","!="],["round","ceil","floor","abs","exp","sqrt","sin","cos","tan","Del","int","Mod","log","pow","min","max"],["asin","acos","atan","cosh","root","tanh","sinh"],["acosh","atanh","asinh","Sigma"]],f=[0,0,0,0,0,0,0,0,0,3,4,5,10,10,14,0,0,0,1,1,1,0,0,0,0,10,0,1,1,1,2,7,0,0,2,1,1,1,9,0,2,0,0,3,0,1,6,9,9,11,12,13,12,8,2,2,2,2,2,2,9,8,8],v={0:11,1:0,2:3,3:0,4:0,5:0,6:0,7:11,8:11,9:1,10:10,11:0,12:11,13:0,14:-1},E={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,9:!0,12:!0,13:!0,14:!0},P={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0},q={0:!0,3:!0,4:!0,8:!0,12:!0,13:!0},b={},k={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,12:!0,13:!0},S={1:!0};function D(t,e){for(var a=0;a<t.length;a++)t[a]+=e;return t}function I(t){for(var e,a,n,o,h=[],u=t.length,p=0;p<u;p++)if(!(p<u-1&&" "===t[p]&&" "===t[p+1])){for(e="",a=t.length-p>l.length-2?l.length-1:t.length-p;0<a;a--)if(void 0!==l[a])for(n=0;n<l[a].length;n++)!function(t,e,a,n){for(var o=0;o<n;o++)if(t[a+o]!==e[o])return;return 1}(t,l[a][n],p,a)||(e=l[a][n],n=l[a].length,a=0);if(p+=e.length-1,""===e)throw new x.Exception("Can't understand after "+t.slice(p));o=s.indexOf(e),h.push({index:o,token:e,type:f[o],eval:i[o],precedence:v[f[o]],show:r[o]})}return h}x.math={isDegree:!1,acos:function(t){return x.math.isDegree?180/Math.PI*Math.acos(t):Math.acos(t)},add:function(t,e){return t+e},asin:function(t){return x.math.isDegree?180/Math.PI*Math.asin(t):Math.asin(t)},atan:function(t){return x.math.isDegree?180/Math.PI*Math.atan(t):Math.atan(t)},acosh:function(t){return Math.log(t+Math.sqrt(t*t-1))},asinh:function(t){return Math.log(t+Math.sqrt(t*t+1))},atanh:function(t){return Math.log((1+t)/(1-t))},C:function(t,e){var a,n=1,o=t-e,h=e;for(e<o&&(h=o,o=e),a=h+1;a<=t;a++)n*=a;return n/x.math.fact(o)},changeSign:function(t){return-t},cos:function(t){return x.math.isDegree&&(t=x.math.toRadian(t)),Math.cos(t)},cosh:function(t){return(Math.pow(Math.E,t)+Math.pow(Math.E,-1*t))/2},div:function(t,e){return t/e},fact:function(t){var e,a;if(t%1!=0)return"NaN";for(e=1,a=2;a<=t;a++)e*=a;return e},inverse:function(t){return 1/t},log:function(t){return Math.log(t)/Math.log(10)},mod:function(t,e){return t%e},mul:function(t,e){return t*e},P:function(t,e){for(var a=1,n=Math.floor(t)-Math.floor(e)+1;n<=Math.floor(t);n++)a*=n;return a},Pi:function(t,e,a){for(var n=1,o=t;o<=e;o++)n*=Number(a.postfixEval({n:o}));return n},pow10x:function(t){for(var e=1;t--;)e*=10;return e},sigma:function(t,e,a){for(var n=0,o=t;o<=e;o++)n+=Number(a.postfixEval({n:o}));return n},sin:function(t){return x.math.isDegree&&(t=x.math.toRadian(t)),Math.sin(t)},sinh:function(t){return(Math.pow(Math.E,t)-Math.pow(Math.E,-1*t))/2},sub:function(t,e){return t-e},tan:function(t){return x.math.isDegree&&(t=x.math.toRadian(t)),Math.tan(t)},tanh:function(t){return x.sinha(t)/x.cosha(t)},toRadian:function(t){return t*Math.PI/180},greaterthan:function(t,e){return e<t?1:0},lessthan:function(t,e){return t<e?1:0},greaterthanorequal:function(t,e){return e<=t?1:0},lessthanorequal:function(t,e){return t<=e?1:0},equals:function(t,e){return String(t)===String(e)?1:0},noteequals:function(t,e){return String(t)!==String(e)?1:0},and:function(t,e){return t&&e?1:0},or:function(t,e){return t||e?1:0},min:function(){var t,e=Array.prototype.slice.call(arguments);return 0===arguments.length?t=0:(t=Math.min.apply(null,e),isNaN(t)&&(t=0)),t},max:function(){var t,e=Array.prototype.slice.call(arguments);return 0===arguments.length?t=0:(t=Math.max.apply(null,e),isNaN(t)&&(t=0)),t}},i=[Math.round,Math.ceil,Math.floor,Math.abs,Math.exp,Math.sqrt,x.math.sin,x.math.cos,x.math.tan,"PI","(",")",x.math.P,x.math.C," ".anchor,x.math.asin,x.math.acos,x.math.atan,"7","8","9",Math.floor,x.math.cosh,x.math.acosh,Math.log,Math.pow,Math.sqrt,"4","5","6",x.math.div,x.math.fact,x.math.tanh,x.math.atanh,x.math.mod,"1","2","3",x.math.and,x.math.or,x.math.mul,x.math.sinh,x.math.asinh,"E",x.math.log,"0",".",x.math.add,x.math.sub,",",x.math.sigma,"n",x.math.Pi,Math.pow,x.math.greaterthan,x.math.lessthan,x.math.greaterthanorequal,x.math.lessthanorequal,x.math.equals,x.math.noteequals,x.math.mod,x.math.min,x.math.max],x.prototype.formulaEval=function(){for(var t,e,a,n=[],o=this.value,h=0;h<o.length;h++)1===o[h].type||3===o[h].type?n.push({value:3===o[h].type?o[h].show:o[h].value,type:1}):13===o[h].type?n.push({value:o[h].show,type:1}):0===o[h].type?n[n.length-1]={value:o[h].show+("-"!==o[h].show?"(":"")+n[n.length-1].value+("-"!==o[h].show?")":""),type:0}:7===o[h].type?n[n.length-1]={value:(1!==n[n.length-1].type?"(":"")+n[n.length-1].value+(1!==n[n.length-1].type?")":"")+o[h].show,type:7}:10===o[h].type?(t=n.pop(),e=n.pop(),"P"===o[h].show||"C"===o[h].show?n.push({value:"<sup>"+e.value+"</sup>"+o[h].show+"<sub>"+t.value+"</sub>",type:10}):n.push({value:(1!==e.type?"(":"")+e.value+(1!==e.type?")":"")+"<sup>"+t.value+"</sup>",type:1})):2===o[h].type||9===o[h].type?(t=n.pop(),e=n.pop(),n.push({value:(1!==e.type?"(":"")+e.value+(1!==e.type?")":"")+o[h].show+(1!==t.type?"(":"")+t.value+(1!==t.type?")":""),type:o[h].type})):12===o[h].type&&(t=n.pop(),e=n.pop(),a=n.pop(),n.push({value:o[h].show+"("+a.value+","+e.value+","+t.value+")",type:12}));return n[0].value},x.addToken=function(t){for(var e,a,n,o=0;o<t.length;o++){for(e=t[o].token.length,a=-1,l[e]=l[e]||[],n=0;n<l[e].length;n++)if(t[o].token===l[e][n]){a=s.indexOf(l[e][n]);break}-1===a?(s.push(t[o].token),f.push(t[o].type),l.length<=t[o].token.length&&(l[t[o].token.length]=[]),l[t[o].token.length].push(t[o].token),i.push(t[o].value),r.push(t[o].show)):(s[a]=t[o].token,f[a]=t[o].type,i[a]=t[o].value,r[a]=t[o].show)}},x.lex=function(t,e){var a,n,o,h,u,p,s,r,i,l={value:x.math.changeSign,type:0,pre:21,show:"-"},f={value:")",show:")",type:5,pre:0},v={value:"(",type:4,pre:0,show:"("},c=[v],y=[],m=E,g=0,w=b,d="",M=I(t);for(void 0!==e&&x.addToken(e),a=0;a<M.length;a++)if(14!==(i=M[a]).type){for(o=i.token,h=i.type,u=i.eval,p=i.precedence,s=i.show,i=c[c.length-1],r=y.length;r--&&0===y[r];)if(-1!==[0,2,3,4,5,9,11,12,13].indexOf(h)){if(!0!==m[h])throw new x.Exception(o+" is not allowed after "+d);c.push(f),m=P,w=k,D(y,-1).pop()}if(!0!==m[h])throw new x.Exception(o+" is not allowed after "+d);if(!0===w[h]&&(h=2,u=x.math.mul,s="&times;",p=3,a-=1),n={value:u,type:h,pre:p,show:s},0===h)m=E,w=b,D(y,2).push(2),c.push(n),c.push(v);else if(1===h)1===i.type?(i.value+=u,D(y,1)):c.push(n),m=P,w=q;else if(2===h)m=E,w=b,D(y,2),c.push(n);else if(3===h)c.push(n),m=P,w=k;else if(4===h)D(y,1),g++,m=E,w=b,c.push(n);else if(5===h){if(!g)throw new x.Exception("Closing parenthesis are more than opening one, wait What!!!");g--,m=P,w=k,c.push(n),D(y,1)}else if(6===h){if(i.hasDec)throw new x.Exception("Two decimals are not allowed in one number");1!==i.type&&(c.push(i={value:0,type:1,pre:0}),D(y,-1)),m=S,D(y,1),w=b,i.value+=u,i.hasDec=!0}else 7===h&&(m=P,w=k,D(y,1),c.push(n));8===h?(m=E,w=b,D(y,4).push(4),c.push(n),c.push(v)):9===h?(9===i.type?i.value===x.math.add?(i.value=u,i.show=s,D(y,1)):i.value===x.math.sub&&"-"===s&&(i.value=x.math.add,i.show="+",D(y,1)):5!==i.type&&7!==i.type&&1!==i.type&&3!==i.type&&13!==i.type?"-"===o&&(m=E,w=b,D(y,2).push(2),c.push(l),c.push(v)):(c.push(n),D(y,2)),m=E,w=b):10===h?(m=E,w=b,D(y,2),c.push(n)):11===h?(m=E,w=b,c.push(n)):12===h?(m=E,w=b,D(y,6).push(6),c.push(n),c.push(v)):13===h&&(m=P,w=k,c.push(n)),D(y,-1),d=o}else if(0<a&&a<M.length-1&&1===M[a+1].type&&(1===M[a-1].type||6===M[a-1].type))throw new x.Exception("Unexpected Space");for(r=y.length;r--&&0===y[r];)c.push(f),D(y,-1).pop();if(!0!==m[5])throw new x.Exception("complete the expression");for(;g--;)c.push(f);return c.push(f),new x(c)},x.Exception=function(t){this.message=t},x.prototype.toPostfix=function(){for(var t,e,a,n,o,h,u=[],p=[{value:"(",type:4,pre:0}],s=this.value,r=1;r<s.length;r++)if(1===s[r].type||3===s[r].type||13===s[r].type)1===s[r].type&&(s[r].value=Number(s[r].value)),u.push(s[r]);else if(4===s[r].type)p.push(s[r]);else if(5===s[r].type)for(;4!==(e=p.pop()).type;)u.push(e);else if(11===s[r].type){for(;4!==(e=p.pop()).type;)u.push(e);p.push(e)}else if(n=(t=s[r]).pre,a=(o=p[p.length-1]).pre,h="Math.pow"===o.value&&"Math.pow"===t.value,a<n)p.push(t);else{for(;n<=a&&!h||h&&n<a;)e=p.pop(),o=p[p.length-1],u.push(e),a=o.pre,h="Math.pow"===t.value&&"Math.pow"===o.value;p.push(t)}return new x(u)},x.prototype.postfixEval=function(t){var e,a,n,o,h,u,p;for((t=t||{}).PI=Math.PI,t.E=Math.E,e=[],h=this.value,u=void 0!==t.n,p=0;p<h.length;p++)1===h[p].type?e.push({value:h[p].value,type:1}):3===h[p].type?e.push({value:t[h[p].value],type:1}):0===h[p].type||7===h[p].type?void 0===e[e.length-1].type?e[e.length-1].value.push(h[p]):e[e.length-1].value=h[p].value(e[e.length-1].value):8===h[p].type?(a=e.pop(),n=e.pop(),e.push({type:1,value:h[p].value(n.value,a.value)})):10===h[p].type?(a=e.pop(),void 0===(n=e.pop()).type?(n.value=n.concat(a),n.value.push(h[p]),e.push(n)):void 0===a.type?(a.unshift(n),a.push(h[p]),e.push(a)):e.push({type:1,value:h[p].value(n.value,a.value)})):2===h[p].type||9===h[p].type?(a=e.pop(),void 0===(n=e.pop()).type?((n=n.concat(a)).push(h[p]),e.push(n)):void 0===a.type?(a.unshift(n),a.push(h[p]),e.push(a)):e.push({type:1,value:h[p].value(n.value,a.value)})):12===h[p].type?(void 0!==(a=e.pop()).type&&(a=[a]),n=e.pop(),o=e.pop(),e.push({type:1,value:h[p].value(o.value,n.value,new x(a))})):13===h[p].type&&(u?e.push({value:t[h[p].value],type:3}):e.push([h[p]]));if(1<e.length)throw new x.Exception("Uncaught Syntax error");return 1e15<e[0].value?"Infinity":parseFloat(e[0].value.toFixed(15))},x.eval=function(t,e,a){return void 0===e?this.lex(t).toPostfix().postfixEval():void 0===a?void 0!==e.length?this.lex(t,e).toPostfix().postfixEval():this.lex(t).toPostfix().postfixEval(e):this.lex(t,e).toPostfix().postfixEval(a)},t.tcmexp=x}(window);