"use strict";(function(){jQuery(document).ready(function(o){var e=function(u){var e=u('form[name="checkout"]');return u('form[name="checkout"]').addClass("wc-checkout-add-ons-dropzone"),e.find(":input.select").each(function(e){var t,o=u(this),n=u(this).closest(".form-row").hasClass("validate-required");if(!u(this).data("select2"))return"function"==typeof(t=u(this)).select2&&t.select2({allowClear:!n,placeholder:u(this).attr("multiple")?wc_checkout_add_ons.select_placeholder_multi:wc_checkout_add_ons.select_placeholder_single}).on("select2:unselecting",function(){return u(this).data("unselecting",!0)}).on("select2:opening",function(e){if(u(this).data("unselecting"))return u(this).removeData("unselecting"),e.preventDefault()}),o.is(":focus")&&o.closest(".form-row").find(".select2-selection").focus(),u().select2}),u(function(){return u("#wc_checkout_add_ons :input").on("change",function(e){return u(this).hasClass("select2-search__field")?void u("body").trigger("update_checkout"):t(e)})}),u(function(){return u("#wc_checkout_add_ons .wc-checkout-add-ons-input-file-plupload").each(function(e){var c=u(this),d=c.find(".wc-checkout-add-ons-dropzone"),a=c.find(".wc-checkout-add-ons-preview"),s=c.find(".wc-checkout-add-ons-progress"),i=c.find(".wc-checkout-add-ons-feedback"),r=c.find('input[type="hidden"]'),t=c.parents(".form-row").prop("id"),o={url:wc_checkout_add_ons.ajax_url,multipart_params:{action:"wc_checkout_add_on_upload_file",security:wc_checkout_add_ons.upload_nonce,field:t},browse_button:d[0],drop_element:d[0],multi_selection:1<wc_checkout_add_ons.max_files,filters:{max_file_size:wc_checkout_add_ons.max_file_size,mime_types:wc_checkout_add_ons.mime_types}},n=new plupload.Uploader(o);return n.init(),n.bind("Error",function(e,t){return i.html("\nError #"+t.code+": "+t.message).removeClass("hide"),s.addClass("hide")}),n.bind("FilesAdded",function(e,t){return i.html("").addClass("hide"),d.addClass("disabled"),s.removeClass("hide"),n.start()}),n.bind("UploadProgress",function(e,t){return s.find(".bar").css("width",t.percent+"%")}),n.bind("FileUploaded",function(e,t,o){var n=u.parseJSON(o.response);return n.errors?(i.html(n.errors.upload_error).removeClass("hide"),s.addClass("hide"),void d.removeClass("disabled")):(r.val(n.id).trigger("change"),a.removeClass("hide").find("a.file").prop("href",n.url).text(n.title),d.addClass("hide").removeClass("disabled"),s.addClass("hide").find(".bar").css("width",0),c.find(".moxie-shim").addClass("hide"))}),c.find("a.remove-file").on("click",function(e){return e.preventDefault(),a.addClass("hide"),d.removeClass("hide disabled"),u.ajax({type:"POST",url:wc_checkout_add_ons.ajax_url,data:{action:"wc_checkout_add_on_remove_file",security:wc_checkout_add_ons.remove_nonce,file:r.val()}}),r.val("").trigger("change"),c.find(".moxie-shim").removeClass("hide")})})})},t=function(e){var t;return o('input[type="file"]').each(function(e){if(o(this).val())return o(this).next().val("1")}),t=o(e.target).attr("id"),o(e.target).one("focusout",function(e){return t=o(e.relatedTarget).attr("id")}),o("body").one("updated_checkout",function(){return o("#"+t).focus(),o("#wc_checkout_add_ons").unblock()}),o("#wc_checkout_add_ons").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),o('form[name="checkout"]').find("select").each(function(e){if(o(this).hasClass("select"))return o(this).select2("destroy")}),o("body").trigger("update_checkout")};return e(o),o(document).on("updated_checkout",function(){return e(o)})})}).call(void 0);