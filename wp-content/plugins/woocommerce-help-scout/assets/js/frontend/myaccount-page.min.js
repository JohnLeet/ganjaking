!function(o){"use strict";o(function(){function e(e){e&&o.blockUI({message:e,baseZ:99999,overlayCSS:{background:"#fff",opacity:.6},css:{padding:"20px",zindex:"9999999",textAlign:"center",color:"#555",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait",lineHeight:"24px"}})}o("#support-conversations-table .conversation-view").on("click",function(r){r.preventDefault(),o("#support-conversation-wrap").show(),o("#support-conversation-wrap-reply").hide();var a=o(this).data("conversation-id"),c=o("#support-conversation-wrap"),t=o(this).data("subject");e(woocommerce_help_scout_myaccount_params.getting_conversation),o.ajax({type:"GET",url:woocommerce_help_scout_myaccount_params.ajax_url,cache:!1,dataType:"json",data:{action:"wc_help_scout_get_conversation",security:woocommerce_help_scout_myaccount_params.security,conversation_id:a},success:function(e){var r="",s=woocommerce_help_scout_myaccount_params.error;o.unblockUI(),null!==e&&""===e.error?(r+='<h3 id="support-conversation-thread-head">"'+t+'":</h3>',r+='<ul id="support-conversation-thread">',o.each(e.threads,function(o,e){r+="<li>",r+="<strong>"+e.author+"</strong> <small>("+e.date+")</small>:",r+=e.message,r+="</li>"}),r+="</ul>",r+='<p><a href="#" data-conversation-id="'+a+'" data-subject="'+t+'" class="button conversation-reply">'+woocommerce_help_scout_myaccount_params.reply+"</a></p>",c.empty().prepend(r),function(){var e=o("#support-conversation-wrap");o("html, body").animate({scrollTop:e.offset().top},500)}()):(null!==e&&null!==e.error&&""!==e.error&&(s=e.error),o(".woocommerce-error",c).remove(),c.prepend('<div class="woocommerce-error">'+s+"</div>"))},error:function(){o.unblockUI(),o(".woocommerce-error",c).remove(),c.prepend('<div class="woocommerce-error">'+woocommerce_help_scout_myaccount_params.error+"</div>")}})}),o("body").on("click",".conversation-reply",function(e){e.preventDefault(),o("#support-conversation-wrap").hide();o("#plUploadArea").html('<div class="input-field"><label class="active">Files</label><div class="my-account-conversation-file-1" style="padding-top: .5rem;"></div></div>'),o(".my-account-conversation-file-1").imageUploader({maxFiles:10,extensions:[".jpg",".jpeg",".png",".pdf",".JPG",".JPEG",".PNG",".PDF"],mimes:["image/jpeg","image/png","image/gif","application/pdf"]});var r,a=o(this).data("subject"),c=o(this).data("conversation-id");o("#support-conversation-wrap-reply").fadeOut(500,function(){o("#support-conversation-thread-head-reply").html(woocommerce_help_scout_myaccount_params.reply_to+" "+a),o("#support-conversation-reply .uploaded").html(""),o("#support-conversation-reply .image-uploader").removeClass("has-files"),o("#reply_conversation_id").val(c),o("#reply_user_id").val(woocommerce_help_scout_myaccount_params.user_id),o("#reply_submit_btn").val(woocommerce_help_scout_myaccount_params.send),o(this).show(),o(".woocommerce-message").remove(),o("#support-conversation-reply").show()}),r=o("#support-conversation-wrap-reply"),o("html, body").animate({scrollTop:r.offset().top},500)}),o("body").on("submit","#support-conversation-reply",function(r){r.preventDefault();var a=o("#support-conversation-wrap-reply"),c=(o("#support-conversation-reply"),o("#support-conversation-thread-head-reply"));e(woocommerce_help_scout_myaccount_params.processing);var t=new FormData;(t=new FormData(o("#support-conversation-reply")[0])).append("action","wc_help_scout_create_thread"),t.append("security",woocommerce_help_scout_form_params.security),o.ajax({type:"POST",url:woocommerce_help_scout_myaccount_params.ajax_url,cache:!1,data:t,dataType:"json",processData:!1,contentType:!1,success:function(e){if(o("#support-conversation-reply")[0].reset(),o("#support-conversation-reply").hide(),o.unblockUI(),null!==e&&1===e.error)o(".woocommerce-error",a).remove(),c.after('<div class="woocommerce-message">'+e.message+"</div>");else{var r=woocommerce_help_scout_myaccount_params.error;null!==e&&null!==e.message&&""!==e.message&&(r=e.message),o(".woocommerce-error",a).remove(),c.after('<div class="woocommerce-error">'+r+"</div>")}},error:function(){o.unblockUI(),o(".woocommerce-error",a).remove(),c.after('<div class="woocommerce-error">'+woocommerce_help_scout_myaccount_params.error+"</div>")}})})})}(jQuery);