jQuery(function(c){c(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:0}),c(".tips-top").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:0,defaultPosition:"top"}),c(".yith-wcmbs-tabs").tabs(),c(".yith-wcmbs-select2").select2(),c(".yith-wcmbs-color-picker").wpColorPicker(),c(".yith-wcmbs-date").datepicker({dateFormat:"yy-mm-dd"});var l={dom:{container:c(".yith-wcmbs-admin-plans-delay").first(),plansList:c("#_yith_wcmbs_restrict_access_plan")},template:wp.template("yith-wcmbs-admin-single-plan-delay"),init:function(){this.dom.container.length&&(this.dom.plansList.on("change",this.plansListChangeHandler).trigger("change"),this.dom.container.on("change",".yith-plugin-fw-radio",this.radioChangeHandler))},plansListChangeHandler:function(){var t,e=c(this),i=l._getRows(),n=e.val(),a=[];for(t in i.each(function(){var t=c(this).data("plan-id")+"";a.push(t),(!n||n.indexOf(t)<0)&&c(this).remove()}),n){var o,s=n[t];(!a.length||a.indexOf(s)<0)&&(o=e.find('option[value="'+s+'"]').html(),(o=c(l.template({planID:s,planName:o}))).find("input[type=radio]").each(function(){var t="_yith_wcmbs_single_plan_delay_"+s+"-"+c(this).val();c(this).attr("id",t),c(this).parent().find("label").attr("for",t)}),l.dom.container.append(o))}},radioChangeHandler:function(){var t=c(this).parent().find(".yith-wcmbs-single-plan-delay-field");"delay"===c(this).val()?t.removeAttr("disabled"):t.attr("disabled","disabled")},_getRows:function(){return l.dom.container.find(".yith-wcmbs-single-plan-delay-row")}},i=(l.init(),c("#yith-wcmbs-plan-item-order-container")),t=i.find("li").get(),e=c("#yith-wcmbs-plan-item-text"),n={message:null,overlayCSS:{background:"#000",opacity:.6},ignoreIfBlocked:!0},a=(t.sort(function(t,e){t=parseInt(c(t).attr("rel")),e=parseInt(c(e).attr("rel"));return t<e?-1:e<t?1:0}),c(t).each(function(t,e){i.append(e)}),i.sortable({items:"li",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.8,revert:!0,stop:function(t,e){e.item.hasClass("yith-wcmbs-plan-item-text")&&e.item.find("input").focus()}}),e.draggable({connectToSortable:"#yith-wcmbs-plan-item-order-container",helper:"clone",revert:"invalid",stop:function(t,e){e.helper.html('<input type="text" name="_yith_wcmbs_plan_items[]" /><span class="dashicons dashicons-no-alt close"></span>'),e.helper.css({height:"auto"})}}),i.on("click",".close",function(t){c(t.target).closest("li").remove()}),i.find("li").disableSelection(),e.disableSelection(),i.on("click",".yith-wcmbs-delete-from-plan",function(t){var t=c(t.target),e=t.closest("li"),i=t.data("post-id"),t=t.data("plan-id");e.block(n),c.ajax({url:ajaxurl,type:"POST",data:{action:"yith_wcmbs_remove_plan_for_post",post_id:i,plan_id:t},success:function(t){console.log(t),e.unblock(),e.remove()}})}),i.on("click",".yith-wcmbs-hide-show-item",function(t){var t=c(t.target),e=t.closest("li").children("input.yith_wcmbs_hidden_item_ids"),i=(t.data("post-id"),"show");"show"==(i=t.is(".dashicons-visibility")?"hide":i)?(e.prop("disabled",!0),t.removeClass("dashicons-hidden").addClass("dashicons-visibility")):(e.prop("disabled",!1),t.removeClass("dashicons-visibility").addClass("dashicons-hidden"))}),c("#bulk_edit").on("click",function(){var t=c("#bulk-edit"),e=[],t=(t.find("#bulk-titles").children().each(function(){e.push(c(this).attr("id").replace(/^(ttle)/i,""))}),c(".plans-checklist",t).find("input:checked")),i=[];t.each(function(){i.push(c(this).val())}),c.ajax({url:ajaxurl,type:"POST","async":!1,cache:!1,data:{action:"yith_wcmbs_save_bulk_edit",post_ids:e,yith_wcmbs_restrict_access_plan:i}})}),c(document).on("yith_wcmbs_select2_init",function(){var t=c(".yith_wcmbs_ajax_select2_select_customer");t.each(function(){var t={allowClear:!!c(this).data("allow_clear"),placeholder:c(this).data("placeholder"),minimumInputLength:c(this).data("minimum_input_length")?c(this).data("minimum_input_length"):"3",escapeMarkup:function(t){return t},ajax:{url:ajaxurl,dataType:"json",quietMillis:250,data:function(t){return{term:t.term,action:"woocommerce_json_search_customers",security:yith_wcmbs_admin.customer_nonce}},processResults:function(t){var i=[];return t&&c.each(t,function(t,e){i.push({id:t,text:e})}),{results:i}},cache:!0}};c(this).select2(t)}),t.on("yith_wcmbs_select2_reset",function(){c(this).val("").trigger("change")}).trigger("yith_wcmbs_select2_reset")}).trigger("yith_wcmbs_select2_init"),c(".yith-wcmbs-select2-select-all").on("click",function(t){t=c(t.target).data("container-id"),t=c("#"+t).find(".yith-wcmbs-select2").first();t.find("option").prop("selected",!0),t.trigger("change")}),c(".yith-wcmbs-select2-deselect-all").on("click",function(t){t=c(t.target).data("container-id"),t=c("#"+t).find(".yith-wcmbs-select2").first();t.find("option:selected").removeAttr("selected"),t.trigger("change")}),c(document).on("click",".yith-wcmbs-copy-to-clipboard",function(t){var e,i=c(this).data("selector-to-copy"),i=c(i);0<i.length&&(e=c("<input>"),c("body").append(e),e.val(i.html()).select(),document.execCommand("copy"),e.remove())}),{target:".yith-wcmbs-show-conditional:not(.yith-wcmbs-show-conditional--initialized)",initEvent:"yith-wcmbs-show-conditional-init",init:function(){c(a.target).hide().each(function(){var n,a,o,t=c(this),e=t.data("dep-selector"),s=c(e),e=t.data("dep-value");s.length&&(a=e.split(","),s.on("change keyup",function(){var i=!0;s.each(function(t){var e=c(this);o=a[t],(n=e.is("input[type=checkbox]"))&&(o="no"!==o),(n?e.is(":checked"):e.val())!==o&&(i=!1)}),i?t.show():t.hide()}).trigger("change"),t.addClass("yith-wcmbs-show-conditional--initialized"))})}}),o=(c(document).on(a.initEvent,a.init),a.init(),{dom:{hideContents:c("#yith-wcmbs-hide-contents"),alternativeContentMode:c("#yith-wcmbs-default-alternative-content-mode"),alternativeContentContainer:c("#yith-wcmbs-default-alternative-content").closest(".yith-plugin-fw-panel-wc-row"),alternativeContentIDContainer:c("#yith-wcmbs-default-alternative-content-id").closest(".yith-plugin-fw-panel-wc-row")},init:function(){var t=o;t.dom.hideContents.on("change",t.handleAlternativeContentVisibility),t.dom.alternativeContentMode.on("change",t.handleAlternativeContentVisibility),t.handleAlternativeContentVisibility()},handleAlternativeContentVisibility:function(){var t=o,e=!1,i=!1;"alternative_content"===t.dom.hideContents.val()&&("set"===t.dom.alternativeContentMode.val()?e=!0:i=!0),e?t.dom.alternativeContentContainer.show():t.dom.alternativeContentContainer.hide(),i?t.dom.alternativeContentIDContainer.show():t.dom.alternativeContentIDContainer.hide()}});o.init()});