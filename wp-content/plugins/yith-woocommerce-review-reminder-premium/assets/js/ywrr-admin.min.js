var array_unique_noempty,element_box;jQuery(function(c){c("body").on("click",".ywrr-send-test-email",function(){var s=c(this).parent(),e=c("#ywrr_email_test").val(),a=c("#ywrr_mail_template").val()||"base";s.find(".ywrr-ajax-result").remove(),s.append('<div class="ywrr-ajax-result"></div>'),/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)?(e={action:"ywrr_send_test_mail",email:e,template:a},s.find(".ywrr-ajax-result").addClass("progress").html(ywrr_admin.before_send_test_email),c.post(ywrr_admin.ajax_url,e,function(e){s.find(".ywrr-ajax-result").removeClass("progress").addClass(!0===e.success?"success":"fail").html(e.message)})):s.find(".ywrr-ajax-result").addClass("fail").html(ywrr_admin.mail_wrong)}).on("click",".ywrr-add-blocklist",function(){var e,s=c(this).parent(),a=c("#add_to_blocklist");s.find(".ywrr-ajax-result").remove(),s.append('<div class="ywrr-ajax-result"></div>'),/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a.val())?(e={action:"ywrr_add_to_blocklist",email:a.val()},s.find(".ywrr-ajax-result").addClass("progress").html(ywrr_admin.please_wait),c.post(ywrr_admin.ajax_url,e,function(e){s.find(".ywrr-ajax-result").removeClass("progress").addClass(!0===e.success?"success":"fail").html(e.message),!0===e.success&&(a.val(""),c.post(document.location.href,function(e){""!==e&&(e=c("<div></div>").html(e).find("#custom-table"),c("#custom-table").html(e.html()))}))})):s.find(".ywrr-ajax-result").addClass("fail").html(ywrr_admin.mail_wrong)}).on("click",".ywrr-bulk-actions",function(){var s=c(this).parent();s.find(".ywrr-ajax-result").remove(),s.append('<div class="ywrr-ajax-result progress">'+ywrr_admin.please_wait+"</div>"),c.post(ywrr_admin.ajax_url,{action:c(this).data("action")},function(e){s.find(".ywrr-ajax-result").removeClass("progress").addClass(!0===e.success?"success":"fail").html(e.message)})}).on("click",".ywrr-compact-list__show-more, .ywrr-compact-list__hide-more",function(e){e.stopPropagation();var e=c(this).closest(".ywrr-compact-list"),s=e.find(".ywrr-compact-list__hidden-items");e.toggleClass("ywrr-compact-list--open"),s.length&&(e.is(".ywrr-compact-list--open")?s.slideDown(300):s.slideUp(300))}),c(".yith-plugins_page_yith_ywrr_panel #doaction, .yith-plugins_page_yith_ywrr_panel #doaction2, .yith-plugins_page_yith_ywrr_panel #search-submit, .yith-plugins_page_yith_ywrr_panel .pagination-links, .yith-plugins_page_yith_ywrr_panel .row-actions a").on("click",function(){window.onbeforeunload=""}),c(function(a){a("select#ywrr_mail_template").on("change",function(){a(this).parent().find(".ywrr-mailskin").remove(),a(this).parent().append('<div class="ywrr-mailskin"><img src="#" /></div>');var e=a(this).val(),s=a(".ywrr-mailskin img");s.fadeOut("fast",function(){s.attr("src",ywrr_admin.assets_url+"/images/skins/"+e+".png").fadeIn("fast")})}).trigger("change"),element_box.init()}),array_unique_noempty=function(e){var a=[];return c.each(e,function(e,s){(s=s.trim())&&-1===c.inArray(s,a)&&a.push(s)}),a},element_box={clean:function(e){return e=e.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,"")},parseTags:function(e){var s=e.id.split("-check-num-")[1],e=c(e).closest(".ywcc-checklist-div"),a=e.find(".ywcc-values"),i=a.val().split(","),t=[];return delete i[s],c.each(i,function(e,s){s&&(s=s.trim(),t.push(s))}),a.val(this.clean(t.join(","))),this.quickClicks(e),!1},quickClicks:function(e){var s=c(".ywcc-values",e),i=c(".ywcc-value-list ul",e),t=c(e).attr("id");s.length&&(e=s.val().split(","),i.empty(),c.each(e,function(e,s){var a;s&&(s=s.trim(),a=c('<li class="select2-selection__choice" />'),(e=c('<span id="'+t+"-check-num-"+e+'" class="select2-selection__choice__remove" tabindex="0"></span>')).on("click keypress",function(e){"click"!==e.type&&13!==e.keyCode||(13===e.keyCode&&c(this).closest(".ywcc-checklist-div").find("input.ywcc-insert").focus(),element_box.parseTags(this))}),a.prepend(s).prepend(e),i.append(a))}))},flushTags:function(e,s,a){var i,t,r=c(".ywcc-values",e),n=c("input.ywcc-insert",e);return void 0!==(t=(s=s||!1)?c(s).text():n.val())&&(i=r.val(),i=this.clean(i=i?i+","+t:t),i=array_unique_noempty(i.split(",")).join(","),r.val(i),this.quickClicks(e),s||n.val(""),void 0===a)&&n.focus(),!1},init:function(){var e=c(".ywcc-checklist-ajax");c(".ywcc-checklist-div").each(function(){element_box.quickClicks(this)}),c("input.ywcc-insert",e).on("keyup",function(e){if(13===e.which)return element_box.flushTags(c(this).closest(".ywcc-checklist-div")),!1}).on("keypress",function(e){if(13===e.which)return e.preventDefault(),!1})}}});