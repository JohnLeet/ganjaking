jQuery(function(c){c("body").on("click","a.ywrr-schedule-actions",function(){var e=c(this);return c(this).WCBackboneModal({template:"ywrr-actions",variable:{button_type:e.data("button-type"),order_id:e.data("order-id"),order_item_id:e.data("order-item-id"),booking_id:e.data("booking-id"),order_date:e.data("order-date"),additional_label:e.data("additional-label"),scheduled_date:e.data("scheduled-date"),row_id:e.parent().prop("id")}}),!1}).on("click","a.ywrr-schedule-delete",function(){var e=c(this);return c(this).WCBackboneModal({template:"ywrr-delete",variable:{order_id:e.data("order-id"),booking_id:e.data("booking-id"),row_id:e.parent().prop("id")}}),!1}).on("click",".ywrr-send-box",function(){return c(this).find("a.ywrr-schedule-actions").trigger("click"),!1}),c(document.body).on("wc_backbone_modal_loaded",function(){c(document).trigger("yith_fields_init"),c(".ywrr-email-action").on("click",function(){var e={},r={},i=c(".ywrr-actions-modal"),o=i.find(".ywrr-order-id").val(),n=i.find(".ywrr-order-date").val(),a=i.find(".ywrr-order-item-id").val(),d=i.find(".ywrr-booking-id").val(),t=i.find("input[type=radio]:checked").val(),l=i.find("#schedule_date").val();if(i.find("#schedule_date").parent().removeClass("is_required").find("span").remove().find(".error-message").html(""),"schedule"!==t||""!==l)return i.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),""!==a&&"0"!==a&&(r[a]=a),e="now"===t?{action:"ywrr_send_request_mail",order_id:o,order_date:n,booking_id:d,items_to_review:JSON.stringify(r,null,"")}:{action:"ywrr_reschedule_mail",order_id:o,booking_id:d,schedule_date:l,items_to_review:JSON.stringify(r,null,"")},c.post(ywrr_actions.ajax_url,e,function(e){!0===e.success?c.post(document.location.href,function(e){var r;""!==e&&(e=c("<div></div>").html(e),r=i.find(".ywrr-row-id").val(),e=e.find("#"+r),c("#"+r).html(e.html()),c(".modal-close").trigger("click"))}):i.find(".error-message").html(e.error),i.unblock()}),!1;i.find("#schedule_date").parent().addClass("is_required").append("<span>"+ywrr_actions.missing_date_error+"</span>")}),c(".ywrr-delete-action").on("click",function(){var i=c(".ywrr-delete-modal"),e=i.find(".ywrr-order-id").val(),r=i.find(".ywrr-booking-id").val();return i.find(".error-message").html(""),i.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),c.post(ywrr_actions.ajax_url,{action:"ywrr_cancel_mail",order_id:e,booking_id:r},function(e){!0===e?c.post(document.location.href,function(e){var r;""!==e&&(e=c("<div></div>").html(e),r=i.find(".ywrr-row-id").val(),e=e.find("#"+r),c("#"+r).html(e.html()),c(".modal-close").click())}):i.find(".error-message").html(e.error),i.unblock()}),!1}),c("input[name=action_type]").on("change",function(){var e=c("input[name=action_type]:checked").val(),r=c(".ywrr-email-action");"now"===e?r.val(ywrr_actions.send_button_label):r.val(ywrr_actions.schedule_button_label)})}),c(function(){var e=c("#bulk-action-selector-top, #bulk-action-selector-bottom");e.append('<option value="ywrr_send">'+ywrr_actions.send_label+"</option>"),e.append('<option value="ywrr_reschedule">'+ywrr_actions.reschedule_label+"</option>"),e.append('<option value="ywrr_cancel">'+ywrr_actions.cancel_label+"</option>"),c(document).trigger("yith_fields_init")})});