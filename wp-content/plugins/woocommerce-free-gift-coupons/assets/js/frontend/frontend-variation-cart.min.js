/*! woocommerce-free-gift-coupons 3.3.0 */

jQuery(document).ready(function(_){function s(t){var a;(a=t).is(".processing")||a.parents(".processing").length||t.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}function d(t){t.removeClass("processing").unblock()}function f(t){return window.matchMedia(t).matches}function t(){_(".woocommerce-cart-form .wc-fgc-auto-open-edit").first().trigger("click")}function e(t){(t=t.find(".product-thumbnail img")).length&&(t.wc_reset_variation_attr("src"),t.wc_reset_variation_attr("width"),t.wc_reset_variation_attr("height"),t.wc_reset_variation_attr("srcset"),t.wc_reset_variation_attr("sizes"),t.wc_reset_variation_attr("title"),t.wc_reset_variation_attr("data-caption"),t.wc_reset_variation_attr("alt"))}_(document).on("reset_data",function(t){t=_(t.target).data("fgc_current_item_row");void 0!==t&&t.length&&(t.find(".wc-fgc-stock-error").html(""),t.find(".wc-fgc-stock-error").hide(),e(t))}),_(document.body).on("updated_wc_div",function(){t()}),_(document).on("click",".wc-fgc-edit-in-cart",function(t){t.preventDefault();var c=_(this),i=_(this).data("cart_item_key"),t=_("tr#wc-fgc-new-row_"+i),o=(c=!c.is(":button")?_(".woocommerce-cart-form").find('.wc-fgc-edit-in-cart[data-cart_item_key="'+i+'"]'):c).closest("tr.wc-fgc-cart-item");if((o=void 0===o||!o.length?t.prevAll("tr.wc-fgc-cart-item:first"):o).addClass("wc-fgc-has-open-panel"),c.is(":button")&&c.fadeOut(),t.length){t.fadeIn();var a=_("#wc_fgc_"+i+" .variations_form");return $scrollTo=f("(max-width:767.9px)")?a:o,_("body,html").animate({scrollTop:$scrollTo.offset().top-50},1e3),void a.find(".variations").find(":input:enabled:visible:first").trigger("focus")}s(_(".woocommerce-cart-form"));var a=_(this).data("product_id"),n=_(this).data("variation_id");_.ajax({url:wc_cart_params.wc_ajax_url.toString().replace("%%endpoint%%","fgc_get_product"),method:"GET",cache:!1,headers:{"cache-control":"no-cache"},data:{product_id:a,variation_id:n,cart_item_key:i}}).done(function(t){var a,r,e;t.success?(_("#wc_fgc_"+i).length||function(t,a,r){var e=0,c=0,i=0;t.children().each(function(t,a){_(a).hasClass("product-name")&&(c=t,i=_(a).width()),++e});var o=e-c,n=wp.template("wc-fgc-edit");t.after(n({cart_item_key:a,colsBeforeProductName:c,colSpan:o,content:r.data})),_("#wc-fgc-new-row_"+a+" td.label").css("width",i)}(o,i,t),(e=(a=_("#wc_fgc_"+i)).find(".variations_form"))&&e.data("fgc_current_item_row",o).wc_variation_form(),r=a.data("product_title"),a=a.data("single_add_to_cart_text"),r=wc_fgc_var_cart_params.i18_update_button_label.replace("%button_text%",a).replace("%product_title%",r),e.find(".single_add_to_cart_button").data("cart_item_key",i).attr("aria-label",r),e.find(".wc-fgc-close-link").data("variation_id",n).toggle(!c.hasClass("wc-fgc-auto-open-edit")),function(t){if(void 0!==t&&Array.isArray(t)){for(attribute in t)_('select[name="'+t[attribute]+'"]').closest("tr").hide();_(".variations_form.cart .reset_variations").hide()}}(c.data("pre_selected_attributes")),e=_("#wc_fgc_"+i+" .variations_form"),$scrollTo=f("(max-width:767.9px)")?e:o,_("body,html").animate({scrollTop:$scrollTo.offset().top-50},1e3),_("body").trigger("wc-fgc-cart-edit-initialized",[i])):(t=void 0===t.data?wc_fgc_var_cart_params.i18n_server_error:t.data,window.alert(t))}).fail(function(t){window.alert(wc_fgc_var_cart_params.i18n_server_error),c.fadeIn()}).always(function(t){d(_(".woocommerce-cart-form"))})}),_(document).on("found_variation",function(t,a){var r=_(t.target).data("fgc_current_item_row");void 0!==r&&r.length&&(t=r,(r=a)&&r.image&&r.image.thumb_src&&1<r.image.thumb_src.length?(a=t.find(".product-thumbnail img")).length&&(a.wc_set_variation_attr("src",r.image.thumb_src),a.wc_set_variation_attr("height",r.image.thumb_src_h),a.wc_set_variation_attr("width",r.image.thumb_src_w),a.wc_set_variation_attr("srcset",r.image.srcset),a.wc_set_variation_attr("sizes",r.image.sizes),a.wc_set_variation_attr("title",r.image.title),a.wc_set_variation_attr("data-caption",r.image.caption),a.wc_set_variation_attr("alt",r.image.alt)):e(t))}),_(document).on("reset_data",function(t){t=_(t.target).data("fgc_current_item_row");void 0!==t&&t.length&&(t.find(".wc-fgc-stock-error").html(""),t.find(".wc-fgc-stock-error").hide(),e(t))}),_(document).on("click",".wc-fgc-new-row .single_add_to_cart_button",function(t){var a,r,e,c;t.preventDefault(),_(this).is(".disabled")||(s(_(".wc-fgc-new-row")),a=_(this).closest(".wc_fgc_cart").attr("id"),r=_("#"+a+" form"),t=_(this).data("cart_item_key"),e={},(c=function(t){t=new FormData(t[0]);return t.delete("add-to-cart"),t}(r)).append("cart_item_key",t),_("#"+a).find("select[name^=attribute]").each(function(){var t=_(this).attr("name"),a=_(this).val();e[t]=a,c.append("variation["+t+"]",a)}),_.ajax({url:wc_cart_params.wc_ajax_url.toString().replace("%%endpoint%%","fgc_update_variation_in_cart"),type:"POST",processData:!1,contentType:!1,cache:!1,headers:{"cache-control":"no-cache"},data:c}).done(function(t){t.success?_('.woocommerce-cart-form [name="update_cart"]').prop("disabled",!1).trigger("click"):(_(".wc-fgc-stock-error").html(t.data),_(".wc-fgc-stock-error").show(),_("form.variations_form").find("div .woocommerce-variation-add-to-cart .input-text").show(),_.scroll_to_notices(_(".wc-fgc-stock-error")))}).fail(function(t){window.alert(wc_fgc_var_cart_params.i18n_variation_update_error)}).always(function(t){d(_(".wc-fgc-new-row"))}))}),_(document).on("click",".wc-fgc-new-row .wc-fgc-close-link",function(t){t.preventDefault(),!_(this).data("variation_id")&&_(this).closest(".wc_fgc_cart").find(".single_add_to_cart_button").is(".disabled")&&window.alert(wc_add_to_cart_variation_params.i18n_make_a_selection_text);var t=_(this).closest(".wc-fgc-new-row"),a=t.attr("id").split("_")[1];t.fadeOut(function(){$updateBtn=_(".wc-fgc-edit-in-cart[data-cart_item_key="+a+"]"),$updateBtn.show()})}),t()});