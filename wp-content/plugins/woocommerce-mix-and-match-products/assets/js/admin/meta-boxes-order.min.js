/*! WooCommerce Mix and Match Products 2.5.2 2023-12-09 18:31 */
jQuery(function(o){var a={$order_items:o("#woocommerce-order-items"),view:!1,handle_events:function(){a.$order_items.on("click","button.configure_container",{action:"configure"},this.clicked_edit_button).on("click","button.edit_container",{action:"edit"},this.clicked_edit_button),o("body").on("wc-mnm-initializing",function(e,t){t.$mnm_button=o("#btn-ok"),t.$mnm_form.data("source","metabox"),t.$mnm_price.after(t.$mnm_reset)})},clicked_edit_button:function(n){n.preventDefault(),a.block(a.$order_items);var e=o(n.target),i=e.data("order_item_id"),e=e.data("container_id");o.ajax({url:wc_mnm_admin_order_params.wc_ajax_url.toString().replace("%%endpoint%%","mnm_get_edit_container_order_item_form"),type:"POST",data:{item_id:i,dataType:"json",order_id:woocommerce_admin_meta_boxes.post_id,container_id:e,security:wc_mnm_admin_order_params.edit_container_nonce,source:"metabox"},success:function(e){var t;e.success&&e.data?(t=o.WCBackboneModal.View.extend({addButton:a.clicked_done_button}),a.view=new t({target:"wc-modal-edit-container",string:{action:"configure"===n.data.action?wc_mnm_admin_order_params.i18n_configure:wc_mnm_admin_order_params.i18n_edit,item_id:i}}),"undefined"!=typeof e.data["div.wc-mnm-edit-container"]&&(a.view.$el.find("article").html(e.data["div.wc-mnm-edit-container"]),a.view.$el.find("form").each(function(){var e=o(this).data("product_type")||"mix-and-match",e=(o(this).trigger("wc-mnm-initialize."+e).data("source","metabox"),new CustomEvent("wc-mnm-initialize."+e,{detail:{source:"metabox",target:this}}));document.dispatchEvent(e)}))):window.alert(e.data)},fail:function(){window.alert(wc_mnm_admin_order_params.i18n_form_error)},complete:function(){a.unblock(a.$order_items)}})},clicked_done_button:function(t){a.block(a.view.$el.find(".wc-backbone-modal-content"));var e=a.view.$el.find(".mnm_form").wc_get_mnm_script(),n=o(document).triggerHandler("wc_mnm_update_container_order_item_data",[e])||{},e=o.extend(a.get_taxable_address(),{item_id:a.view._string.item_id,dataType:"json",order_id:woocommerce_admin_meta_boxes.post_id,security:wc_mnm_admin_order_params.edit_container_nonce,config:e?e.api.get_container_config():[],source:"metabox"},n);o.ajax({url:wc_mnm_admin_order_params.wc_ajax_url.toString().replace("%%endpoint%%","mnm_update_container_order_item"),type:"POST",data:e,success:function(e){e.success?("undefined"!=typeof e.data.html&&(a.$order_items.find(".inside").empty(),a.$order_items.find(".inside").append(e.data.html),a.$order_items.trigger("wc_order_items_reloaded")),"undefined"!=typeof e.data.notes_html&&(o("ul.order_notes").empty(),o("ul.order_notes").append(o(e.data.notes_html).find("li"))),a.unblock(a.view.$el.find(".wc-backbone-modal-content")),a.block(a.$order_items,{fadeIn:0}),setTimeout(function(){a.unblock(a.$order_items)},250),a.view.closeButton(t)):(window.alert(e.data),a.unblock(a.view.$el.find(".wc-backbone-modal-content")))},fail:function(){window.alert(wc_mnm_admin_order_params.i18n_form_error)}})},get_taxable_address:function(){var e="",t="",n="",i="";return"shipping"===woocommerce_admin_meta_boxes.tax_based_on&&(e=o("#_shipping_country").val(),t=o("#_shipping_state").val(),n=o("#_shipping_postcode").val(),i=o("#_shipping_city").val()),"billing"!==woocommerce_admin_meta_boxes.tax_based_on&&e||(e=o("#_billing_country").val(),t=o("#_billing_state").val(),n=o("#_billing_postcode").val(),i=o("#_billing_city").val()),{country:e,state:t,postcode:n,city:i}},block:function(e,t){t=o.extend({},{message:null,overlayCSS:{background:"#fff",opacity:.6}},t||{});e.block(t)},unblock:function(e){e.unblock()}};a.handle_events()});