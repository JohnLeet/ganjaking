/*! WooCommerce Mix and Match Products 2.5.0 2023-09-27 13:17 */
jQuery(function(o){var a={$order_items:o("#woocommerce-order-items"),view:!1,handle_events:function(){a.$order_items.on("click","button.configure_container",{action:"configure"},this.clicked_edit_button).on("click","button.edit_container",{action:"edit"},this.clicked_edit_button),o("body").on("wc-mnm-initializing",function(e,n){n.$mnm_button=o("#btn-ok"),n.$mnm_form.data("source","metabox"),n.$mnm_price.after(n.$mnm_reset)})},clicked_edit_button:function(t){t.preventDefault(),a.block(a.$order_items);var e=o(t.target),i=e.data("order_item_id"),e=e.data("container_id");o.ajax({url:wc_mnm_admin_order_params.wc_ajax_url.toString().replace("%%endpoint%%","mnm_get_edit_container_order_item_form"),type:"POST",data:{item_id:i,dataType:"json",order_id:woocommerce_admin_meta_boxes.post_id,container_id:e,security:wc_mnm_admin_order_params.edit_container_nonce,source:"metabox"},success:function(e){var n;e.success&&e.data?(n=o.WCBackboneModal.View.extend({addButton:a.clicked_done_button}),a.view=new n({target:"wc-modal-edit-container",string:{action:"configure"===t.data.action?wc_mnm_admin_order_params.i18n_configure:wc_mnm_admin_order_params.i18n_edit,item_id:i}}),"undefined"!=typeof e.data["div.wc-mnm-edit-container"]&&(a.view.$el.find("article").html(e.data["div.wc-mnm-edit-container"]),a.view.$el.find("form").each(function(){var e=o(this).data("product_type")||"mix-and-match";o(this).trigger("wc-mnm-initialize."+e).data("source","metabox")}))):window.alert(e.data)},fail:function(){window.alert(wc_mnm_admin_order_params.i18n_form_error)},complete:function(){a.unblock(a.$order_items)}})},clicked_done_button:function(n){a.block(a.view.$el.find(".wc-backbone-modal-content"));var e=a.view.$el.find(".mnm_form").wc_get_mnm_script(),t=o(document).triggerHandler("wc_mnm_update_container_order_item_data",[e])||{},e=o.extend(a.get_taxable_address(),{item_id:a.view._string.item_id,dataType:"json",order_id:woocommerce_admin_meta_boxes.post_id,security:wc_mnm_admin_order_params.edit_container_nonce,config:void 0!==e?e.api.get_container_config():[],source:"metabox"},t);o.ajax({url:wc_mnm_admin_order_params.wc_ajax_url.toString().replace("%%endpoint%%","mnm_update_container_order_item"),type:"POST",data:e,success:function(e){e.success?("undefined"!=typeof e.data.html&&(a.$order_items.find(".inside").empty(),a.$order_items.find(".inside").append(e.data.html),a.$order_items.trigger("wc_order_items_reloaded")),"undefined"!=typeof e.data.notes_html&&(o("ul.order_notes").empty(),o("ul.order_notes").append(o(e.data.notes_html).find("li"))),a.unblock(a.view.$el.find(".wc-backbone-modal-content")),a.block(a.$order_items,{fadeIn:0}),setTimeout(function(){a.unblock(a.$order_items)},250),a.view.closeButton(n)):(window.alert(e.data),a.unblock(a.view.$el.find(".wc-backbone-modal-content")))},fail:function(){window.alert(wc_mnm_admin_order_params.i18n_form_error)}})},get_taxable_address:function(){var e="",n="",t="",i="";return"shipping"===woocommerce_admin_meta_boxes.tax_based_on&&(e=o("#_shipping_country").val(),n=o("#_shipping_state").val(),t=o("#_shipping_postcode").val(),i=o("#_shipping_city").val()),"billing"!==woocommerce_admin_meta_boxes.tax_based_on&&e||(e=o("#_billing_country").val(),n=o("#_billing_state").val(),t=o("#_billing_postcode").val(),i=o("#_billing_city").val()),{country:e,state:n,postcode:t,city:i}},block:function(e,n){n=o.extend({},{message:null,overlayCSS:{background:"#fff",opacity:.6}},n||{});e.block(n)},unblock:function(e){e.unblock()}};a.handle_events()});