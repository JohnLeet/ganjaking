jQuery(document).ready(function(u){woocommerce_admin.ywf_error_message_refund=ywf_params.messages.error_message_refund,woocommerce_admin.ywf_error_message_wrong_funds=ywf_params.messages.error_wrong_funds,u(".button.refund-items").on("click",function(e){var n,a,o,t,r,d,_,m,i,c;u(".ywf_available_user_fund").length&&(n=u(".wc-order-refund-items"),a=u(".ywf_available_user_fund").val(),t=(o=n.find("tr:nth-child(3)")).find("td.total"),d=(r=o.find("td.label")).html(),_=t.find("span.amount").text(),m=accounting.formatMoney(a,{symbol:woocommerce_admin_meta_boxes.currency_format_symbol,decimal:woocommerce_admin_meta_boxes.currency_format_decimal_sep,thousand:woocommerce_admin_meta_boxes.currency_format_thousand_sep,precision:woocommerce_admin_meta_boxes.currency_format_num_decimals,format:woocommerce_admin_meta_boxes.currency_format}),t.find("span.ywf_ref_amount").length||(a<accounting.unformat(_,woocommerce_admin.mon_decimal_point)&&t.html('<span class="amount ywf_ref_amount"><del>'+_+"</del> "+m),r.html('<span class="woocommerce-help-tip" data-tip="'+ywf_params.messages.tot_av_refund_tip+'"></span> '+d),u(".woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})),1===u("#order_line_items tr.item").length&&(i=u("#order_line_items tr.item"),c=u(".ywf_available_user_fund").val(),i.find("input.line_total").val(c),i.find("input.line_total").attr("data-total",c)))}),u(".wc-order-refund-items").on("change keyup","#refund_amount",function(e){var n=u(".ywf_available_user_fund"),a=u(this).val();n.length&&(n.val()<accounting.unformat(a,woocommerce_admin.mon_decimal_point)?(u(".refund-actions button").attr("disabled","disabled"),u(document.body).triggerHandler("wc_add_error_tip",[u(this),"ywf_error_message_refund"])):(u(document.body).triggerHandler("wc_remove_error_tip",[u(this),"ywf_error_message_refund"]),u(".refund-actions button").attr("disabled",!1)))});var e,n;(n=u(document).find("#ywf_partial_payment")).length&&"yes"==n.val()&&(u(document).find(".refund-actions button.do-api-refund").remove(),(e=u("<p>")).css({color:"red","padding-right":"10px","margin-top":"20px"}),e.addClass("ywf_refund_warning"),e.html(ywf_params.messages.no_automatic_refund),e.appendTo(u(document).find(".refund-actions"))),u(document).on("click",".ywf_add_funds.button",function(e){e.preventDefault();var n=u(document).find("#post_ID").val(),a=u(document).find("#yith_customer_id").val(),o=u(document).find("#yith_add_funds").val(),t={order_id:n,customer_id:a,funds_to_add:o,action:ywf_params.actions.add_funds},r={message:null,overlayCSS:{background:"#fff",opacity:.6},ignoreIfBlocked:!0};0<o?u.ajax({type:"POST",url:ywf_params.ajax_url,data:t,dataType:"json",beforeSend:function(){u("#yith-wc-order-account-funds-metabox").block(r)},success:function(e){u(document).find("#yith_add_funds").val(""),u(document).find("#add_order_note").val(e),u(document).find(".add_note.button").click()},complete:function(){u("#yith-wc-order-account-funds-metabox").unblock()}}):u(document.body).triggerHandler("wc_add_error_tip",[u(document).find("#yith_add_funds"),"ywf_error_message_wrong_funds"])})});