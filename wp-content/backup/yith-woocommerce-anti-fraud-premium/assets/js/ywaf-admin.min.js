var array_unique_noempty,element_box;jQuery(function(o){o(".ywaf-start-check, .ywaf-repeat-check").click(function(){var c=o(".ywaf-risk-container"),e=o(this).is(".ywaf-repeat-check")?"true":"false";return c.is(".processing")||(c.addClass("processing"),c.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),o.ajax({type:"POST",url:ywaf.ajax_url,data:{repeat:e},success:function(e){"success"===e.status?-1!==e.redirect.indexOf("https://")||-1!==e.redirect.indexOf("http://")?window.location=e.redirect:window.location=decodeURI(e.redirect):(c.removeClass("processing").unblock(),window.alert(e.error))},dataType:"json"})),!1}),o(document).ready(function(c){c("#ywaf_risk").knob({draw:function(){c(".ywaf-risk-container-knob").show()}}),c(".ywaf-thresholds").change(function(){var e=parseInt(c(this).val());c(this).is(".ywaf-high")?c(".ywaf-medium").prop("max",e-1):c(this).is(".ywaf-medium")&&c(".ywaf-high").prop("min",e+1)}).change(),element_box.init()}),array_unique_noempty=function(e){var i=[];return o.each(e,function(e,c){(c=o.trim(c))&&-1===o.inArray(c,i)&&i.push(c)}),i},element_box={clean:function(e){return e=e.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,"")},parseTags:function(e){var c=e.id.split("-check-num-")[1],i=o(e).closest(".ywcc-checklist-div"),t=i.find(".ywcc-values"),n=t.val().split(","),s=[];return delete n[c],o.each(n,function(e,c){(c=o.trim(c))&&s.push(c)}),t.val(this.clean(s.join(","))),this.quickClicks(i),!1},quickClicks:function(e){var c,i=o(".ywcc-values",e),n=o(".ywcc-value-list ul",e),s=o(e).attr("id");i.length&&(c=i.val().split(","),n.empty(),o.each(c,function(e,c){var i,t;(c=o.trim(c))&&(i=o('<li class="select2-selection__choice" />'),(t=o('<span id="'+s+"-check-num-"+e+'" class="select2-selection__choice__remove" tabindex="0"></span>')).on("click keypress",function(e){"click"!==e.type&&13!==e.keyCode||(13===e.keyCode&&o(this).closest(".ywcc-checklist-div").find("input.ywcc-insert").focus(),element_box.parseTags(this))}),i.prepend(c).prepend(t),n.append(i))}))},flushTags:function(e,c,i){var t,n,s,a=o(".ywcc-values",e),r=o("input.ywcc-insert",e);return void 0===(s=(c=c||!1)?o(c).text():r.val())||(n=(t=a.val())?t+","+s:s,n=this.clean(n),n=array_unique_noempty(n.split(",")).join(","),a.val(n),this.quickClicks(e),c||r.val(""),void 0===i&&r.focus()),!1},init:function(){var e=o(".ywcc-checklist-ajax");o(".ywcc-checklist-div").each(function(){element_box.quickClicks(this)}),o("input.ywcc-insert",e).keyup(function(e){if(13===e.which)return element_box.flushTags(o(this).closest(".ywcc-checklist-div")),!1}).keypress(function(e){if(13===e.which)return e.preventDefault(),!1})}}});