jQuery(function(c){c("body").on("click","a.ywrr-schedule-actions",function(){var e=c(this);return c(this).WCBackboneModal({template:"ywrr-actions",variable:{button_type:e.data("button-type"),order_id:e.data("order-id"),order_item_id:e.data("order-item-id"),booking_id:e.data("booking-id"),order_date:e.data("order-date"),additional_label:e.data("additional-label"),scheduled_date:e.data("scheduled-date"),row_id:e.parent().prop("id")}}),!1}).on("click","a.ywrr-schedule-delete",function(){var e=c(this);return c(this).WCBackboneModal({template:"ywrr-delete",variable:{order_id:e.data("order-id"),booking_id:e.data("booking-id"),row_id:e.parent().prop("id")}}),!1}).on("click",".ywrr-send-box",function(){return c(this).find("a.ywrr-schedule-actions").click(),!1}),c(document.body).on("wc_backbone_modal_loaded",function(){c(document).trigger("yith_fields_init"),c(".ywrr-email-action").click(function(){var e={},r={},a=c(".ywrr-actions-modal"),i=a.find(".ywrr-order-id").val(),o=a.find(".ywrr-order-date").val(),d=a.find(".ywrr-order-item-id").val(),n=a.find(".ywrr-booking-id").val(),t=a.find("input[type=radio]:checked").val(),l=a.find("#schedule_date").val();if(a.find("#schedule_date").parent().removeClass("is_required").find("span").remove().find(".error-message").html(""),"schedule"!==t||""!==l)return a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),""!==d&&"0"!==d&&(r[d]=d),e="now"===t?{action:"ywrr_send_request_mail",order_id:i,order_date:o,booking_id:n,items_to_review:JSON.stringify(r,null,"")}:{action:"ywrr_reschedule_mail",order_id:i,booking_id:n,schedule_date:l,items_to_review:JSON.stringify(r,null,"")},c.post(ywrr_actions.ajax_url,e,function(e){!0===e.success?c.post(document.location.href,function(e){if(""!==e){var r=c("<div></div>").html(e),i=a.find(".ywrr-row-id").val(),o=r.find("#"+i);c("#"+i).html(o.html()),c(".modal-close").click()}}):a.find(".error-message").html(e.error),a.unblock()}),!1;a.find("#schedule_date").parent().addClass("is_required").append("<span>"+ywrr_actions.missing_date_error+"</span>")}),c(".ywrr-delete-action").click(function(){var a=c(".ywrr-delete-modal"),e=a.find(".ywrr-order-id").val(),r=a.find(".ywrr-booking-id").val();a.find(".error-message").html(""),a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var i={action:"ywrr_cancel_mail",order_id:e,booking_id:r};return c.post(ywrr_actions.ajax_url,i,function(e){!0===e?c.post(document.location.href,function(e){if(""!==e){var r=c("<div></div>").html(e),i=a.find(".ywrr-row-id").val(),o=r.find("#"+i);c("#"+i).html(o.html()),c(".modal-close").click()}}):a.find(".error-message").html(e.error),a.unblock()}),!1}),c("input[name=action_type]").change(function(){var e=c("input[name=action_type]:checked").val(),r=c(".ywrr-email-action");"now"===e?r.val(ywrr_actions.send_button_label):r.val(ywrr_actions.schedule_button_label)})}),c(document).ready(function(){var e=c("#bulk-action-selector-top, #bulk-action-selector-bottom");e.append('<option value="ywrr_send">'+ywrr_actions.send_label+"</option>"),e.append('<option value="ywrr_reschedule">'+ywrr_actions.reschedule_label+"</option>"),e.append('<option value="ywrr_cancel">'+ywrr_actions.cancel_label+"</option>")})});