jQuery(document).ready(function(o){"use strict";var t,l,n;o(".yith-wrvp-shortcode-tab").each(function(){var e=o(this).find("input.shortcode-option, select.shortcode-option"),c=o(this).find(".shortcode-preview");e.each(function(){o(this).on("change",function(){var e,i,t,s,a;"radio"==this.type&&!o(this).is(":checked")||(e="checkbox"!=this.type||o(this).is(":checked")?o(this).val():o(this).data("novalue"),i=o(this).data("attr_name"),a=c.html(),s=new RegExp(i+'="([^"]*)"',"g"),a=a.replace(s,""),e?(a=a.replace("]",""),t=i+'="'+e+'"',c.html(a+" "+t+"]")):c.html(a))})})}),o(document).on("click","button.ywrvp-send-test-email",function(){o(this).prev().val(!0)}),o(document).find("input.yith_wrvp_coupon_validate").on("keyup",function(){var i=o(this),e=i.val();t&&t.abort(),e?(i.addClass("loading"),t=o.ajax({url:ajaxurl,data:{action:"yith_wrvp_validate_coupon",code:e},dataType:"json",success:function(e){i.removeClass("loading"),e.valid?i.removeClass("error").addClass("valid"):i.removeClass("valid").addClass("error")}})):i.removeClass("error valid loading")}).keyup(),o(document).find("select, input").on("change",function(){var e=o(this),i=o(document).find('[data-deps="'+e.attr("name")+'"]'),t=e.val();if(i.length){if(e.is(":checkbox")&&(t=e.is(":checked")?"yes":"no"),e.is(":radio")&&!e.is(":checked"))return;o.each(i,function(){var e=void 0!==o(this).data("deps_value")?o(this).data("deps_value").split(","):"",i=o(this).closest("tr");-1!==o.inArray(t,e)||!e&&t?i.show():i.hide()})}}).change(),l=function(e){var t=[];return o.each(e,function(e,i){(i=o.trim(i))&&-1===o.inArray(i,t)&&t.push(i)}),t},(n={clean:function(e){return e=e.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,"")},parseTags:function(e){var i=e.id.split("-check-num-")[1],t=o(e).closest(".ywrvp-checklist-div"),s=t.find(".ywrvp-values"),a=s.val().split(","),c=[];return delete a[i],o.each(a,function(e,i){(i=o.trim(i))&&c.push(i)}),s.val(this.clean(c.join(","))),this.quickClicks(t),!1},quickClicks:function(e){var i,t=o(".ywrvp-values",e),a=o(".ywrvp-value-list ul",e),c=o(e).attr("id");t.length&&(i=t.val().split(","),a.empty(),o.each(i,function(e,i){var t,s;(i=o.trim(i))&&(t=o('<li class="select2-search-choice" />'),(s=o('<a id="'+c+"-check-num-"+e+'" class="select2-search-choice-close" tabindex="0"></a>')).on("click keypress",function(e){"click"!==e.type&&13!==e.keyCode||(13===e.keyCode&&o(this).closest(".ywrvp-checklist-div").find("input.ywrvp-insert").focus(),n.parseTags(this))}),t.prepend('<div><div class="selected-option" data-id="'+i+'">'+i+"</div></div>").prepend(s),a.append(t))}))},flushTags:function(e,i,t){var s,a,c,n=o(".ywrvp-values",e),r=o("input.ywrvp-insert",e);return void 0===(c=(i=i||!1)?o(i).text():r.val())||(a=(s=n.val())?s+","+c:c,a=this.clean(a),a=l(a.split(",")).join(","),n.val(a),this.quickClicks(e),i||r.val(""),void 0===t&&r.focus()),!1},init:function(){var e=o(".ywrvp-checklist-ajax");o(".ywrvp-checklist-div").each(function(){n.quickClicks(this)}),o("input.ywrvp-insert",e).keyup(function(e){if(13==e.which)return n.flushTags(o(this).closest(".ywrvp-checklist-div")),!1}).keypress(function(e){if(13==e.which)return e.preventDefault(),!1})}}).init(),o(document).on("click",".yith-wrvp-shortcode-tabs-nav a",function(e){e.preventDefault();var i=o(document).find(o(this).attr("href")),t=o(this).closest("li");if(!i.length)return!1;t.addClass("active").siblings().removeClass("active"),i.show().siblings(".yith-wrvp-shortcode-tab").hide()})});