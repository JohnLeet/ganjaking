/**
 * Custom ThankYou page preview (Classic Editor)
 *
 * @category Script
 * @package  Yith Custom Thank You Page for Woocommerce
 * @author    Armando Liccardo
 * @license  http://www.gnu.org/licenses/gpl-3.0.txt GNU GENERAL PUBLIC LICENSE (GPL 3.0)
 * @link http://www.yithemes.com
 */
jQuery(function(e){e(document).ready(function(){"use strict";var t={yctpw_url_part:"",has_preview_link:"no",saving:!1,p_window:null,ajax_url:yctpw_preview_args.admin_ajax_url,pcontent:"",init:function(){jQuery(document).on("heartbeat-tick.autosave",function(e,r){1==t.saving&&(t.openPreview(),t.saving=!1)}),t.pcontent=wp.autosave.getPostData().content},doPreview:function(e){t.yctpw_url_part=e.attr("url-part"),this.pcontent!=wp.autosave.getPostData().content?(this.saving=!0,wp.autosave.server.triggerSave(),this.has_preview_link="yes"):t.openPreview()},openPreview:function(){e.ajax({async:!0,type:"POST",url:this.ajax_url,data:{action:"yith_ctpw_get_preview_link",post_id:yctpw_preview_args.post_id,has_preview:this.has_preview_link},success:function(e){""==t.p_window||null==t.p_window||t.p_window.closed?t.p_window=window.open(e+"&"+t.yctpw_url_part,"yctpw_preview"):t.p_window.location.href=e+"&"+t.yctpw_url_part,t.p_window.focus()}})}};t.init(),e(".yctpw_preview_button a").on("click",function(r){r.preventDefault(),t.doPreview(e(this))}),e(".button.yctpw_create_dummy_order").on("click",function(t){t.preventDefault();var r=yctpw_preview_args.admin_ajax_url;e.post(r,{action:"yith_ctpw_create_dummy_order"},function(t){if(t.response){e(".yctpw_preview_dummy_order").hide();var r="order-received="+t.order_id+"&key="+t.order_key+"&ctpw="+e("#post_ID").val();e(".yctpw_preview_button a").attr("url-part",r),e(".yctpw_preview_button p").html(yctpw_preview_args.preview_message_dummy_order+" "+t.order_id),e(".yctpw_preview_button").show()}else console.log(t.message)},"json")})})});