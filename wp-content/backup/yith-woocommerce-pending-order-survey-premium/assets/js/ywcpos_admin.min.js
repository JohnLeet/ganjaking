jQuery(document).ready(function(n){"use strict";var t=n(".pending_order_surveys_list"),e=n("#ywcpos_pending_order_survey_report-container"),o=function(){n("div.survey_question",t).each(function(e){n(this).find(".survey_order").val(e)})},i=function(){n(".survey_question.closed").each(function(){n(this).find(".ywcpos_survey_content").hide()})};i(),n(".single_report.closed").each(function(){n(this).find(".answers_container").hide()}),t.sortable({items:"div.survey_question",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.8,revert:!0,axis:"y",handle:"h3",stop:function(e,s){o()}}),n(".add_survey_question").on("click",function(e){e.preventDefault();var s={ywcpos_loop:t.find("div.survey_question").length,action:ywcpos_params.actions.add_new_question};n.ajax({type:"POST",url:ywcpos_params.admin_url,data:s,dataType:"json",success:function(e){t.append(e.result),i()}})}),t.on("click",".survey_question h3",function(e){n(e.target).filter(":input, option").length||(n(this).next(".ywcpos_survey_content").stop().slideToggle(),n(this).parent(".survey_question").toggleClass("closed").toggleClass("open"))}),e.on("click",".single_report h3",function(e){n(e.target).filter(":input, option").length||(n(this).next(".answers_container").stop().slideToggle(),n(this).parent(".single_report").toggleClass("closed").toggleClass("open"))}),t.on("click",".survey_question h3 .remove_question",function(e){e.preventDefault();var s=n(this).parent().parent();setTimeout(function(){s.remove()},500),o()}),t.on("blur change",".qst_txt",function(e){n(this).parents(".survey_question").find("h3 span.survey_qst").html(n(this).val())}),n(".ywcpos_send_email").on("click",function(e){e.preventDefault();var s=n(this),t={ywcpos_order_id:s.data("order_id"),ywcpos_template:s.prev(".ywcpos_template_email").val(),action:ywcpos_params.actions.send_pending_email};s.after('<img src="'+ywcpos_params.ajax_loader+'">'),n.ajax({type:"POST",url:ywcpos_params.admin_url,data:t,dataType:"json",success:function(e){s.next().remove()}})});var a=e.data("max_char"),r=e.data("show_more_txt"),s=e.data("show_less_txt");n(".ywcpos_more").each(function(){var e,s=n(this).html();s.length>a&&(e=s.substr(0,a)+'<span class="ywcpos_morecontent"><span>'+s.substr(a,s.length-a)+'</span>&nbsp;&nbsp;<a href="" class="ywcpos_morelink">'+r+"</a></span>",n(this).html(e))}),n(".ywcpos_morelink").click(function(){return n(this).hasClass("less")?(n(this).removeClass("less"),n(this).html(r)):(n(this).addClass("less"),n(this).html(s)),n(this).parent().prev().toggle("slow"),n(this).prev().toggle(),!1})});