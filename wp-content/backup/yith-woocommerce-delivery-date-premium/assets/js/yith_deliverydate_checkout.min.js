jQuery(document).ready(function(r){var o="",t=r("#ywcdd_carrier").val(),i=function(){return 1<r(".shipping_method").length?r(".shipping_method:checked").val():r(".shipping_method").val()},a=function(){var e=r(document).find("#ywcdd_process_method").val(),d=r(document).find("#ywcdd_carrier").val(),t={ywcdd_carrier_id:d,ywcdd_process_id:e,action:ywcdd_params.actions.update_datepicker};r(document).find("#ywcdd_datepicker").datepicker("destroy"),""!==d?r.ajax({type:"POST",url:ywcdd_params.ajax_url,data:t,dataType:"json",success:function(e){"undefined"!=typeof e.available_days?r(document).trigger("ywcdd_found_available_days",[e.available_days,d]):r("form.checkout").unblock()}}):(r(document).find(".ywcdd_datepicker_content").hide(),r(document).find(".ywcdd_timeslot_content").hide(),r("form.checkout").unblock())},c={message:null,overlayCSS:{background:"#fff",opacity:.6},ignoreIfBlocked:!0};r(document).on("ywcdd_found_available_days",function(e,a,d){var o,t,c,i=r(document).find("#ywcdd_datepicker"),n=i.parents(".ywcdd_datepicker_content");o=a,r.each(o,function(e,d){var t="";try{var a=new Date(1e3*d);a.setTime(a.getTime()+60*(new Date).getTimezoneOffset()*1e3),t=r.datepicker.formatDate(ywcdd_params.dateformat,a),o[e]=t}catch(c){t=null}}),a=o,i.datepicker({dateFormat:ywcdd_params.dateformat,numberOfMonths:+ywcdd_params.numberOfMonths,yearSuffix:ywcdd_params.yearSuffix,beforeShow:function(e,d){r("#ui-datepicker-div").removeClass("yith_datepicker"),r("#ui-datepicker-div").addClass("yith_datepicker"),setTimeout(function(){r("#ui-datepicker-div").show()},0)},beforeShowDay:function(e){var d=a,t=r.datepicker.formatDate(ywcdd_params.dateformat,e);return[-1!==d.indexOf(t)]},onSelect:function(e,d){var t,a,c,o=d.selectedMonth+1,i=d.selectedDay,n=d.selectedYear+"-"+o+"-"+i;r(document).find(".ywcdd_delivery_date").val(n),t=n,a=r(document).find("#ywcdd_carrier").val(),c={ywcdd_carrier_id:a,ywcdd_date_selected:t,action:ywcdd_params.actions.update_timeslot},r.ajax({type:"POST",url:ywcdd_params.ajax_url,data:c,dataType:"json",success:function(e){var d=e.available_timeslot;r(document).trigger("ywcdd_found_time_slots",[d,t,a])}})},onClose:function(e,d){var t=a;void 0!==t&&-1===t.indexOf(e)&&(alert("Error: the date "+e+" isn't available"),i.datepicker("setDate",t[0]),r(".ui-datepicker-current-day").click())}}),void 0!==a&&0<a.length&&(t=a[0],c=a[a.length-1],i.datepicker("option","minDate",t),i.datepicker("option","maxDate",c),"yes"===ywcdd_params.show_the_min_date&&(i.datepicker("setDate",t),r(".ui-datepicker-current-day").click())),n.show(),"yes"===ywcdd_params.open_datepicker&&i.datepicker("show"),r("form.checkout").unblock()}),r(document).on("ywcdd_found_time_slots",function(e,d,t,a){var c=r(document).find(".ywcdd_timeslot_content"),o=c.find("#ywcdd_timeslot"),i=c.find(".ywcdd_timeslot_av");o.find("option").not("[value='']").remove(),r.isEmptyObject(d)?(i.val("no"),c.hide()):(r.each(d,function(e,d){o.append(r("<option></option>").attr("value",e).html(d))}),c.show(),i.val("yes")),o.select2(),o.trigger("change"),r("form.checkout").unblock()}),r("form.checkout").on("change","#ywcdd_timeslot",function(e){e.originalEvent!==undefined&&r("form.checkout").block(c),r("body").trigger("update_checkout")}).on("change","#ywcdd_carrier",function(e){var d=r(this).val();d!==t&&(t=d,r("form.checkout").block(c),a())}),r(document.body).on("updated_checkout",function(e,d){var t,a,c;t=r(document).find("#ywcdd_process_method").val(),a=i(),c={ywcdd_update_carrier:"update_carrier",ywcdd_shipping_id:a,ywcdd_process_method:t,action:ywcdd_params.actions.update_carrier_list},o!==a?r.ajax({type:"POST",url:ywcdd_params.ajax_url,data:c,dataType:"json",success:function(e){e.update_delivery_form&&(""!==e.template?r(".ywcdd_select_delivery_date_content").replaceWith(e.template):r(".ywcdd_select_delivery_date_content").html(""),r("body").trigger("init-delivery-fields"))}}):r("form.checkout").unblock()}),r(document).on("init-delivery-fields",function(e){r("form.checkout").block(c),o=i(),r(document).find("#ywcdd_carrier").select2(),a()}).trigger("init-delivery-fields"),r("body").on("update_checkout",function(){r("form.checkout").block(c)})});