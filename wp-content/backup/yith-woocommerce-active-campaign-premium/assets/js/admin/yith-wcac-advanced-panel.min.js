jQuery(document).ready(function(d){var f=d("body"),c=d(".advanced-integration-content"),a=d("#add_options_set"),i=[],g=[];d("#yith_wcac_active_campaign_integration_mode").on("change",function(){var j=d(this);if(j.val()=="simple"){d("#yith_wcac_active_campaign_list").parents("tr").show();d("#yith_wcac_active_campaign_tags").parents("tr").show();d(".yith_wcac_active_campaign_tags").hide();a.parents("tr").hide()}else{d("#yith_wcac_active_campaign_list").parents("tr").hide();d("#yith_wcac_active_campaign_tags").parents("tr").hide();d(".yith_wcac_active_campaign_tags").show();a.parents("tr").show()}}).change();d(document).on("click","#add_options_set",function(k){var j=d(this);k.preventDefault();d.ajax({beforeSend:function(){j.block({message:null,overlayCSS:{background:"#fff",opacity:0.6}})},complete:function(){j.unblock()},data:{action:yith_wcac_advanced_panel.actions.wcac_add_advanced_panel_item_action,item_id:yith_wcac_advanced_panel.item_id},dataType:"html",error:function(){},method:"POST",success:function(l){if(l.length!=0){c.prepend(l);d(c.find(".advanced-panel-item").get(0)).hide().slideDown();yith_wcac_advanced_panel.item_id++;h();f.trigger("wc-enhanced-select-init");f.trigger("add_updater_handler")}},url:ajaxurl})});var h=function(){d(".advanced-panel-item .panel-item-handle a.collapse-button").off("click").on("click",function(m){var j=d(this),k=j.parents(".advanced-panel-item"),l=k.find(".panel-item-content");m.preventDefault();l.slideToggle(300,function(){k.toggleClass("opened")})});d(".advanced-panel-item .panel-item-handle a.remove-button").off("click").on("click",function(l){var j=d(this),k=j.parents(".advanced-panel-item");l.preventDefault();k.slideUp(300,function(){d(this).remove()})});d(".advanced-panel-item a.add-field").off("click").on("click",function(m){var k=d(this),l=k.parents(".advanced-panel-item"),j=l.data("id");m.preventDefault();d.ajax({beforeSend:function(){k.block({message:null,overlayCSS:{background:"#fff",opacity:0.6}});if("undefined"==typeof(i[j])){i[j]=l.find(".field-item").length+1}},complete:function(){k.unblock();i[j]=i[j]+1},data:{action:yith_wcac_advanced_panel.actions.wcac_add_advanced_panel_field_action,item_id:j,field_id:("undefined"==typeof(i[j]))?l.find(".field-item").length+1:i[j],list_id:k.parents(".advanced-panel-item").find("select.list-select").val()},dataType:"html",error:function(){},method:"POST",success:function(n){if(n.length!=0){k.parents(".section").find(".fields-content").prepend(n);d(k.parents(".section").find(".fields-content .field-item").get(0)).hide().slideDown();f.trigger("wc-enhanced-select-init");b()}},url:ajaxurl})});d(".advanced-panel-item a.add-condition").off("click").on("click",function(m){var k=d(this),l=k.parents(".advanced-panel-item"),j=l.data("id");m.preventDefault();d.ajax({beforeSend:function(){k.block({message:null,overlayCSS:{background:"#fff",opacity:0.6}});if("undefined"==typeof(g[j])){g[j]=l.find(".condition-item").length+1}},complete:function(){k.unblock();g[j]=g[j]+1},data:{action:yith_wcac_advanced_panel.actions.wcac_add_advanced_panel_condition_action,item_id:j,condition_id:("undefined"==typeof(g[j]))?l.find(".condition-item").length+1:g[j]},dataType:"html",error:function(){},method:"POST",success:function(n){if(n.length!=0){k.parents(".section").find(".conditions-content").prepend(n);d(k.parents(".section").find(".conditions-content .condition-item").get(0)).hide().slideDown();f.trigger("wc-enhanced-select-init");b()}},url:ajaxurl})})},e=function(o){var v=d(this),j=v.val(),l=v.parent().next(),u=l.find(".condition_op_mixed"),s=l.find(".condition_op_set"),q=l.find(".condition_op_number"),r=l.find(".condition_products.enhanced").add(l.find(".condition_products.enhanced").next()),n=l.find(".condition_cats.enhanced").add(l.find(".condition_cats.enhanced").next()),m=l.find(".condition_total"),p=l.find(".condition_key"),k=l.find(".condition_value");l.fadeOut(300,function(){switch(j){case"product_in_cart":u.hide();s.show();q.hide();r.removeClass("select-hidden");n.addClass("select-hidden");m.hide();p.hide();k.hide();break;case"product_cat_in_cart":u.hide();s.show();q.hide();r.addClass("select-hidden");n.removeClass("select-hidden");m.hide();p.hide();k.hide();break;case"order_total":u.hide();s.hide();q.show();r.addClass("select-hidden");n.addClass("select-hidden");m.show();p.hide();k.hide();break;case"custom":u.show();s.hide();q.hide();r.addClass("select-hidden");n.addClass("select-hidden");m.hide();p.show();k.show();break}l.fadeIn()})},b=function(){d(".advanced-panel-item .panel-item-content .field-item a.remove-button").on("click",function(l){var j=d(this),k=j.parents(".field-item");l.preventDefault();k.slideUp(300,function(){d(this).remove()})});d(".advanced-panel-item .panel-item-content .field-item a.update-fields").on("click",function(l){var k=d(this),j=k.parent().find("select"),m=j.val(),n=k.parents(".panel-item-content").find("select.list-select").val();console.log("bbb");l.preventDefault();d.ajax({beforeSend:function(){k.block({message:null,overlayCSS:{background:"#fff",opacity:0.6}})},complete:function(){k.unblock()},data:{force_update:true,action:yith_wcac.actions.wcac_get_fields_via_ajax_action,yith_wcac_ajax_request_nonce:yith_wcac.ajax_request_nonce},dataType:"json",method:"POST",success:function(o){var q="",p=0;jQuery.each(o,function(r,s){q+='<option value="'+r+'" '+((m==r)?'selected="selected"':"")+" >"+s.title+"</option>"});j.html(q);if(q.length==0){j.prop("disabled")}else{j.removeProp("disabled")}},url:ajaxurl})});d(".advanced-panel-item .panel-item-content .condition-item a.remove-button").on("click",function(l){var j=d(this),k=j.parents(".condition-item");l.preventDefault();k.slideUp(300,function(){d(this).remove()})});d(".advanced-panel-item .panel-item-content .condition-item select.condition_type").on("change",e).change()};h();b();d("#yith_wcac_advanced_integration_show_tags").select2({allowClear:true,minimumResultsForSearch:Infinity,tokenSeparators:[","," "]})});