jQuery(document).ready(function(c){var i=c(document).find(".ywdpd_popup"),o={message:null,overlayCSS:{background:"#fff",opacity:.6},ignoreIfBlocked:!0},a=function(){i.fadeOut(300),c(document).trigger("wc_update_cart")},_=function(d){var t=d.data("allowed_items")-1;d.data("allowed_items",t),0<t?d.find(".ywdpd_quantity").html(t):d.addClass("hide_rule"),c(document).trigger("ywdpd_counter_updated",[t,d])},d=function(){i.find(".ywdpd_product_stage").each(function(){var d=c(this).find(".ywdpd_products.owl-carousel"),t=d.find("li").size();t=3<t?3:t,d.owlCarousel({loop:!1,margin:10,nav:!1,responsive:{0:{items:1},600:{items:t},1e3:{items:t}}}),d.on("onInitialized",setTimeout(function(){n()},500))})},r=function(){i.find(".ywdpd_step2").fadeOut(300,function(){i.find(".ywdpd_step1").fadeIn(300),i.find(".ywdpd_step2").html("")})},n=function(){var d=i.find(".ywdpd_popup_wrapper"),t=d.outerWidth(),n=d.outerHeight(),a=c(window).width(),e=c(window).height();d.css({position:"fixed",top:(e-n)/2+"px",left:(a-t)/2+"px"})};d(),i.fadeIn(300),i.on("click",".ywdpd_close",a),i.on("click",".ywdpd_step1 ul.ywdpd_products.products li a",function(d){d.preventDefault();var t=c(this).parent(),n=t.data("product_id"),a=t.data("ywdpd_rule_id");if("simple"===t.data("product_type")){var e={product_id:n=t.data("product_id"),rule_id:a=t.data("ywdpd_rule_id"),action:ywdpd_popup_args.actions.add_gift_to_cart};c.ajax({type:"POST",url:ywdpd_popup_args.ajax_url,data:e,dataType:"json",beforeSend:function(){t.parents(".ywdpd_product_stage").block(o)},success:function(d){t.addClass("added"),_(c(document).find("#ywdpd_single_rule_"+a))},complete:function(){t.parents(".ywdpd_product_stage").unblock()}})}else{e={product_id:n,rule_id:a,action:ywdpd_popup_args.actions.show_second_step};c.ajax({type:"POST",url:ywdpd_popup_args.ajax_url,data:e,dataType:"json",beforeSend:function(){t.find("img.ywdpd_loader").show()},success:function(d){var t;""!==d.template&&(t=d.template,i.find(".ywdpd_step1").fadeOut(300,function(){i.find(".ywdpd_step2").html(t),i.find(".ywdpd_step2 .variations_form").each(function(){c(this).wc_variation_form()}),p(),u(),i.find(".ywdpd_step2").fadeIn(300)}))},complete:function(){t.find("img.ywdpd_loader").hide()}})}});var p=function(){c(".variations_form.cart").on("found_variation",function(d,t){var n=c(this),a={ywdp_check_rule_id:c(this).parent().find(".ywdpd_rule_id").val(),product_id:t.variation_id,action:ywdpd_popup_args.actions.check_variable};c.ajax({type:"POST",url:ywdpd_popup_args.ajax_url,data:a,dataType:"json",beforeSend:function(){n.block(o)},success:function(d){d.variation_found?c(".ywdpd_add_to_gift").attr("disabled",!0):c(".ywdpd_add_to_gift").attr("disabled",!1)},complete:function(){n.unblock()}})}).on("reset_data",function(d){c(".ywdpd_add_to_gift").attr("disabled",!0)})},u=function(){c(document).on("click",".ywdpd_add_to_gift",function(d){d.preventDefault();var t,n,a=c('input[name="product_id"]'),e=c("input.variation_id"),i=(t=c(document).find('select[name^="attribute"]'),n={},t.each(function(){var d=c(this),t=d.attr("name");n[t]=d.val()}),n),o=c("input.ywdpd_rule_id"),p={product_id:a.val(),variation_id:e.val(),rule_id:o.val(),variations:i,action:ywdpd_popup_args.actions.add_gift_to_cart},u=c(this);c.ajax({type:"POST",url:ywdpd_popup_args.ajax_url,data:p,dataType:"json",beforeSend:function(){u.addClass("loading")},success:function(d){var t=c(document).find("#ywdpd_single_rule_"+o.val());t.find('ul.ywdpd_products li[data-product_id="'+a.val()+'"]').addClass("added"),_(t),r()},complete:function(){u.removeClass("loading")}})})};c(document).on("ywdpd_counter_updated",function(d,t,n){0==i.find(".ywdpd_single_rule_container").not(".hide_rule").size()?a():i.find(".ywdpd_single_rule_container.hide_rule").fadeOut(300)}),c(document).on("click",".ywdpd_back",function(d){r()}),c(document).on("click",".ywdpd_footer a",function(d){d.preventDefault(),a()}),c(document).on("keyup",function(d){27==d.keyCode&&a()}),c(window).on("resize",function(){n()})});