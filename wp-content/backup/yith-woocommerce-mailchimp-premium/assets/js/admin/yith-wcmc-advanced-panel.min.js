jQuery(document).ready(function(e){var n=e("body"),t=e(".advanced-integration-content"),i=e("#add_options_set"),a=[],d=[];e("#yith_wcmc_mailchimp_integration_mode").on("change",function(){"simple"==e(this).val()?(e("#yith_wcmc_mailchimp_list").parents("tr").show(),e("#yith_wcmc_mailchimp_groups").parents("tr").show(),i.parents("tr").hide()):(e("#yith_wcmc_mailchimp_list").parents("tr").hide(),e("#yith_wcmc_mailchimp_groups").parents("tr").hide(),i.parents("tr").show())}).change(),e(document).on("click","#add_options_set",function(i){var a=e(this);i.preventDefault(),e.ajax({beforeSend:function(){a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},complete:function(){a.unblock()},data:{action:yith_wcmc_advanced_panel.actions.add_advanced_panel_item_action,item_id:yith_wcmc_advanced_panel.item_id},dataType:"html",error:function(){},method:"POST",success:function(i){0!=i.length&&(t.prepend(i),e(t.find(".advanced-panel-item").get(0)).hide().slideDown(),yith_wcmc_advanced_panel.item_id++,c(),n.trigger("wc-enhanced-select-init"),n.trigger("add_updater_handler"))},url:ajaxurl})});var c=function(){e(".advanced-panel-item .panel-item-handle a.collapse-button").off("click").on("click",function(n){var t=e(this).parents(".advanced-panel-item"),i=t.find(".panel-item-content");n.preventDefault(),i.slideToggle(300,function(){t.toggleClass("opened")})}),e(".advanced-panel-item .panel-item-handle a.remove-button").off("click").on("click",function(n){var t=e(this).parents(".advanced-panel-item");n.preventDefault(),t.slideUp(300,function(){e(this).remove()})}),e(".advanced-panel-item a.add-field").off("click").on("click",function(t){var i=e(this),d=i.parents(".advanced-panel-item"),c=d.data("id");t.preventDefault(),e.ajax({beforeSend:function(){i.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),void 0===a[c]&&(a[c]=d.find(".field-item").length+1)},complete:function(){i.unblock(),a[c]=a[c]+1},data:{action:yith_wcmc_advanced_panel.actions.add_advanced_panel_field_action,item_id:c,field_id:void 0===a[c]?d.find(".field-item").length+1:a[c],list_id:i.parents(".advanced-panel-item").find("select.list-select").val()},dataType:"html",error:function(){},method:"POST",success:function(t){0!=t.length&&(i.parents(".section").find(".fields-content").prepend(t),e(i.parents(".section").find(".fields-content .field-item").get(0)).hide().slideDown(),n.trigger("wc-enhanced-select-init"),l())},url:ajaxurl})}),e(".advanced-panel-item a.add-condition").off("click").on("click",function(t){var i=e(this),a=i.parents(".advanced-panel-item"),c=a.data("id");t.preventDefault(),e.ajax({beforeSend:function(){i.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),void 0===d[c]&&(d[c]=a.find(".condition-item").length+1)},complete:function(){i.unblock(),d[c]=d[c]+1},data:{action:yith_wcmc_advanced_panel.actions.add_advanced_panel_condition_action,item_id:c,condition_id:void 0===d[c]?a.find(".condition-item").length+1:d[c]},dataType:"html",error:function(){},method:"POST",success:function(t){0!=t.length&&(i.parents(".section").find(".conditions-content").prepend(t),e(i.parents(".section").find(".conditions-content .condition-item").get(0)).hide().slideDown(),n.trigger("wc-enhanced-select-init"),l())},url:ajaxurl})})},o=function(n){var t=e(this),i=t.val(),a=t.parent().next(),d=a.find(".condition_op_mixed"),c=a.find(".condition_op_set"),o=a.find(".condition_op_number"),l=a.find(".condition_products.enhanced").add(a.find(".condition_products.enhanced").next()),s=a.find(".condition_cats.enhanced").add(a.find(".condition_cats.enhanced").next()),r=a.find(".condition_total"),p=a.find(".condition_key"),f=a.find(".condition_value");a.fadeOut(300,function(){switch(i){case"product_in_cart":d.hide(),c.show(),o.hide(),l.removeClass("select-hidden"),s.addClass("select-hidden"),r.hide(),p.hide(),f.hide();break;case"product_cat_in_cart":d.hide(),c.show(),o.hide(),l.addClass("select-hidden"),s.removeClass("select-hidden"),r.hide(),p.hide(),f.hide();break;case"order_total":d.hide(),c.hide(),o.show(),l.addClass("select-hidden"),s.addClass("select-hidden"),r.show(),p.hide(),f.hide();break;case"custom":d.show(),c.hide(),o.hide(),l.addClass("select-hidden"),s.addClass("select-hidden"),r.hide(),p.show(),f.show()}a.fadeIn()})},l=function(){e(".advanced-panel-item .panel-item-content .field-item a.remove-button").on("click",function(n){var t=e(this).parents(".field-item");n.preventDefault(),t.slideUp(300,function(){e(this).remove()})}),e(".advanced-panel-item .panel-item-content .field-item a.update-fields").on("click",function(n){var t=e(this),i=t.parent().find("select"),a=i.val(),d=t.parents(".panel-item-content").find("select.list-select").val();n.preventDefault(),e.ajax({beforeSend:function(){t.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},complete:function(){t.unblock()},data:{list:d,force_update:!0,action:yith_wcmc.actions.retrieve_fields_via_ajax_action,yith_wcmc_ajax_request_nonce:yith_wcmc.ajax_request_nonce},dataType:"json",method:"POST",success:function(e){var n="",t=0;if(0!=e.length)for(t in e)n+='<option value="'+t+'" '+(t==a?'selected="selected"':"")+" >"+e[t]+"</option>";i.html(n),0==n.length?i.prop("disabled"):i.removeProp("disabled")},url:ajaxurl})}),e(".advanced-panel-item .panel-item-content .condition-item a.remove-button").on("click",function(n){var t=e(this).parents(".condition-item");n.preventDefault(),t.slideUp(300,function(){e(this).remove()})}),e(".advanced-panel-item .panel-item-content .condition-item select.condition_type").on("change",o).change()};c(),l()});